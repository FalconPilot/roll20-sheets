<div class="sc-wrapper flex-col flex-middle">

  <input type="hidden" name="attr_expert_skill_multiplier" value="2" />
  <input type="hidden" name="attr_master_skill_multiplier" value="3" />
  <input type="hidden" name="attr_basic_skill_malus" value="10" />
  <input type="hidden" name="attr_advanced_skill_malus" value="20" />
  <input type="hidden" name="attr_current_tab" class="tabs-control" value="character" />

  <!-- Tab selector -->
  <div class="tab-selector full-width flex-row">
    <button type="action" name="act_character">Personnage</button>
    <button type="action" name="act_protections">Santé / Protections</button>
    <button type="action" name="act_arsenal">Arsenal</button>
    <button type="action" name="act_gear">Inventaire</button>
    <button type="action" name="act_psy">Psy / Karma</button>
    <button type="action" name="act_mutations">Mutations</button>
    <button type="action" name="act_xp">Expérience</button>
  </div>

  <!-- Character tab -->
  <div class="tab flex-col full-width flex-middle character">

    <!-- Character bio -->
    <div class="tablet heading full-width">
      <table class="full-width">
        <tbody>
          <tr class="tablet-line">
            <td class="label">Nom complet</td>
            <td class="full-width">
              <input type="text" class="full-width" name="attr_character_name" />
            </td>
          </tr>
          <tr class="tablet-line">
            <td class="label">Race</td>
            <td class="full-width">
              <div class="full-width flex-row center-v">
                <select name="attr_character_race">
                  <option value="human">Humain</option>
                  <option value="doppleganger">Doppleganger</option>
                  <option value="endaari">Endaari</option>
                  <option value="alkor">Alkor</option>
                  <option value="drone">Drone</option>
                  <option value="troll">Troll</option>
                  <option value="changelin">Changelin</option>
                  <option value="other">Autre</option>
                </select>
                <input type="hidden" name="attr_character_race" value="human" />
                <input type="text" name="attr_character_race_other" class="full-width" placeholder="Nom de la race" />
              </div>
            </td>
          </tr>
          <tr class="tablet-line">
            <td class="label">Sexe</td>
            <td class="full-width">
              <div class="full-width flex-row center-v">
                <select name="attr_character_gender">
                  <option value="?">?</option>
                  <option value="m">M</option>
                  <option value="f">F</option>
                  <option value="other">Autre</option>
                </select>
                <input type="hidden" name="attr_character_gender" value="?" />
                <input type="text" name="attr_character_gender_other" class="full-width" placeholder="Genre" />
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    <div class="tablet-content flex-col flex-middle full-width tablet-stats">

      <!-- Character stats -->
      <table class="stats">
        <tbody>
          <tr>

            <!-- Physique -->
            <td>
              <div class="stat left flex-row flex-middle">
                <button type="roll" value="&{template:general} {{character_name=@{character_name}}} {{roll_title=Physique}} {{target=[[?{Bonus/Malus|0} + @{phy_total}]]}} {{roll=[[1D100cs<5cf>96]]}}"></button>
                <div class="stat-bubble flex-col flex-middle">
                  <input type="hidden" name="attr_phy_total" value="0" />
                  <input
                    disabled
                    type="number"
                    name="attr_phy_total_display"
                    value="@{phy_total}"
                    class="stat-total"
                  />
                  <div class="stat-base">
                    <input type="number" value="0" min="0" name="attr_phy_base" />
                  </div>
                </div>
                <div class="stat-label flex-row">
                  <p class="stat-name">Physique</p>
                  <div class="stat-plus flex-row flex-middle">
                    <p>+</p>
                    <input type="number" value="0" min="0" name="attr_phy_bonus" />
                  </div>
                </div>
              </div>
            </td>

            <!-- Agilité -->
            <td>
              <div class="stat right flex-row flex-middle">
                <div class="stat-label flex-row">
                  <p class="stat-name">Agilité</p>
                  <div class="stat-plus flex-row flex-middle">
                    <p>+</p>
                    <input type="number" value="0" min="0" name="attr_agi_bonus" />
                  </div>
                </div>
                <div class="stat-bubble flex-col flex-middle">
                  <input type="hidden" name="attr_agi_total" value="0" />
                  <input
                    disabled
                    type="number"
                    name="attr_agi_total_display"
                    value="@{agi_total}"
                    class="stat-total"
                  />
                  <div class="stat-base">
                    <input type="number" value="0" min="0" name="attr_agi_base" />
                  </div>
                </div>
                <button type="roll" value="&{template:general} {{character_name=@{character_name}}} {{roll_title=Agilité}} {{target=[[?{Bonus/Malus|0} + @{agi_total}]]}} {{roll=[[1D100cs<5cf>96]]}}"></button>
              </div>
            </td>
          </tr>
          <tr>

            <!-- Acuité -->
            <td>
              <div class="stat left flex-row flex-middle">
                <button type="roll" value="&{template:general} {{character_name=@{character_name}}} {{roll_title=Acuité}} {{target=[[?{Bonus/Malus|0} + @{acu_total}]]}} {{roll=[[1D100cs<5cf>96]]}}"></button>
                <div class="stat-bubble flex-col flex-middle">
                  <input type="hidden" name="attr_acu_total" value="0" />
                  <input
                    disabled
                    type="number"
                    name="attr_acu_total_display"
                    value="@{acu_total}"
                    class="stat-total"
                  />
                  <div class="stat-base">
                    <input type="number" value="0" min="0" name="attr_acu_base" />
                  </div>
                </div>
                <div class="stat-label">
                  <div class="stat-plus flex-row flex-middle">
                    <p>+</p>
                    <input type="number" value="0" min="0" name="attr_acu_bonus" />
                  </div>
                  <p class="stat-name">Acuité</p>
                </div>
              </div>
            </td>

            <!-- Habilité -->
            <td>
              <div class="stat right flex-row flex-middle">
                <div class="stat-label flex-row">
                  <p class="stat-name">Habilité</p>
                  <div class="stat-plus flex-row flex-middle">
                    <p>+</p>
                    <input type="number" value="0" min="0" name="attr_hab_bonus" />
                  </div>
                </div>
                <div class="stat-bubble flex-col flex-middle">
                  <input type="hidden" name="attr_hab_total" value="0" />
                  <input
                    disabled
                    type="number"
                    name="attr_hab_total_display"
                    value="@{hab_total}"
                    class="stat-total"
                  />
                  <div class="stat-base">
                    <input type="number" value="0" min="0" name="attr_hab_base" />
                  </div>
                </div>
                <button type="roll" value="&{template:general} {{character_name=@{character_name}}} {{roll_title=Habilité}} {{target=[[?{Bonus/Malus|0} + @{hab_total}]]}} {{roll=[[1D100cs<5cf>96]]}}"></button>
              </div>
            </td>
          </tr>
          <tr>

            <!-- Charisme -->
            <td>
              <div class="stat left flex-row flex-middle">
                <button type="roll" value="&{template:general} {{character_name=@{character_name}}} {{roll_title=Charisme}} {{target=[[?{Bonus/Malus|0} + @{cha_total}]]}} {{roll=[[1D100cs<5cf>96]]}}"></button>
                <div class="stat-bubble flex-col flex-middle">
                  <input type="hidden" name="attr_cha_total" value="0" />
                  <input
                    disabled
                    type="number"
                    name="attr_cha_total_display"
                    value="@{cha_total}"
                    class="stat-total"
                  />
                  <div class="stat-base">
                    <input type="number" value="0" min="0" name="attr_cha_base" />
                  </div>
                </div>
                <div class="stat-label">
                  <div class="stat-plus flex-row flex-middle">
                    <p>+</p>
                    <input type="number" value="0" min="0" name="attr_cha_bonus" />
                  </div>
                  <p class="stat-name">Charisme</p>
                </div>
              </div>
            </td>

            <!-- Empathie -->
            <td>
              <div class="stat right flex-row flex-middle">
                <div class="stat-label">
                  <div class="stat-plus flex-row flex-middle">
                    <p>+</p>
                    <input type="number" value="0" min="0" name="attr_emp_bonus" />
                  </div>
                  <p class="stat-name">Empathie</p>
                </div>
                <div class="stat-bubble flex-col flex-middle">
                  <input type="hidden" name="attr_emp_total" value="0" />
                  <input
                    disabled
                    type="number"
                    name="attr_emp_total_display"
                    value="@{emp_total}"
                    class="stat-total"
                  />
                  <div class="stat-base">
                    <input type="number" value="0" min="0" name="attr_emp_base" />
                  </div>
                </div>
                <button type="roll" value="&{template:general} {{character_name=@{character_name}}} {{roll_title=Empathie}} {{target=[[?{Bonus/Malus|0} + @{emp_total}]]}} {{roll=[[1D100cs<5cf>96]]}}"></button>
              </div>
            </td>
          </tr>
          <tr>

            <!-- Intelligence -->
            <td>
              <div class="stat left flex-row flex-middle">
                <button type="roll" value="&{template:general} {{character_name=@{character_name}}} {{roll_title=Intelligence}} {{target=[[?{Bonus/Malus|0} + @{int_total}]]}} {{roll=[[1D100cs<5cf>96]]}}"></button>
                <div class="stat-bubble flex-col flex-middle">
                  <input type="hidden" name="attr_int_total" value="0" />
                  <input
                    disabled
                    type="number"
                    name="attr_int_total_display"
                    value="@{int_total}"
                    class="stat-total"
                  />
                  <div class="stat-base">
                    <input type="number" value="0" min="0" name="attr_int_base" />
                  </div>
                </div>
                <div class="stat-label flex-row">
                  <p class="stat-name">Intelligence</p>
                  <div class="stat-plus flex-row flex-middle">
                    <p>+</p>
                    <input type="number" value="0" min="0" name="attr_int_bonus" />
                  </div>
                </div>
              </div>
            </td>

            <!-- Volonté -->
            <td>
              <div class="stat right flex-row flex-middle">
                <div class="stat-label">
                  <div class="stat-plus flex-row flex-middle">
                    <p>+</p>
                    <input type="number" value="0" min="0" name="attr_wil_bonus" />
                  </div>
                  <p class="stat-name">Volonté</p>
                </div>
                <div class="stat-bubble flex-col flex-middle">
                  <input type="hidden" name="attr_wil_total" value="0" />
                  <input
                    disabled
                    type="number"
                    name="attr_wil_total_display"
                    value="@{wil_total}"
                    class="stat-total"
                  />
                  <div class="stat-base">
                    <input type="number" value="0" min="0" name="attr_wil_base" />
                  </div>
                </div>
                <button type="roll" value="&{template:general} {{character_name=@{character_name}}} {{roll_title=Volonté}} {{target=[[?{Bonus/Malus|0} + @{wil_total}]]}} {{roll=[[1D100cs<5cf>96]]}}"></button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>

      <div class="full-width flex-row">
        <div class="half-width flex-col">

          <!-- Basic Skills -->
          <table class="skills full-width">
            <thead>
              <tr>
                <th colspan="8">
                  <div class="table-title">Compétences de base</div>
                </th>
              </tr>
              <tr>
                <th>Nom</th>
                <th>1.</th>
                <th></th>
                <th>2.</th>
                <th class="trained"></th>
                <th class="expert"></th>
                <th class="master"></th>
                <th></th>
              </tr>
            </thead>
            <tbody>
              <tr class="skill">
                <td class="full-width">
                  <input
                    type="text"
                    class="full-width line-input"
                    name="attr_acro_name"
                    value="Acrobaties"
                    disabled
                  />
                </td>
                <td>
                  <input type="hidden" name="attr_character_main_stat" value="@{agi_total}" />
                  <select disabled>
                    <option selected>AGI</option>
                  </select>
                </td>
                <td class="bonus"></td>
                <td>
                  <input type="hidden" name="attr_character_bonus_stat" value="@{phy_total}" />
                  <select disabled>
                    <option selected>PHY</option>
                  </select>
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_acro_trained"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_acro_expert"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_acro_master"
                  />
                </td>
                <td>
                  <button
                    type="roll"
                    value="&{template:general} {{character_name=@{character_name}}} {{roll_title=@{acro_name}}} {{target=[[?{Bonus/Malus|0} + @{character_main_stat} - @{basic_skill_malus} + @{acro_trained} * @{basic_skill_malus} + @{acro_expert} * (floor(@{character_bonus_stat} / 10) * @{expert_skill_multiplier}) + @{acro_master} * (floor(@{character_bonus_stat} / 10) * @{master_skill_multiplier})]]}} {{roll=[[1D100cs<5cf>96]]}}"
                  ></button>
                </td>
              </tr>
              <tr class="skill">
                <td class="full-width">
                  <input
                    type="text"
                    class="full-width line-input"
                    name="attr_guns_name"
                    value="Armes de tir"
                    disabled
                  />
                </td>
                <td>
                  <input type="hidden" name="attr_guns_main_stat" value="@{acu_total}" />
                  <select disabled>
                    <option selected>ACU</option>
                  </select>
                </td>
                <td class="bonus"></td>
                <td>
                  <input type="hidden" name="attr_guns_bonus_stat" value="@{hab_total}" />
                  <select disabled>
                    <option selected>HAB</option>
                  </select>
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_guns_trained"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_guns_expert"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_guns_master"
                  />
                </td>
                <td>
                  <button
                    type="roll"
                    value="&{template:general} {{character_name=@{character_name}}} {{roll_title=@{guns_name}}} {{target=[[?{Bonus/Malus|0} + @{guns_main_stat} - @{basic_skill_malus} + @{guns_trained} * @{basic_skill_malus} + @{guns_expert} * (floor(@{guns_bonus_stat} / 10) * @{expert_skill_multiplier}) + @{guns_master} * (floor(@{guns_bonus_stat} / 10) * @{master_skill_multiplier})]]}} {{roll=[[1D100cs<5cf>96]]}}"
                  ></button>
                </td>
              </tr>
              <tr class="skill">
                <td class="full-width">
                  <input
                    type="text"
                    class="full-width line-input"
                    name="attr_throw_name"
                    value="Armes de jet"
                    disabled
                  />
                </td>
                <td>
                  <input type="hidden" name="attr_throw_main_stat" value="@{hab_total}" />
                  <select disabled>
                    <option selected>HAB</option>
                  </select>
                </td>
                <td class="bonus"></td>
                <td>
                  <input type="hidden" name="attr_throw_bonus_stat" value="@{acu_total}" />
                  <select disabled>
                    <option selected>ACU</option>
                  </select>
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_throw_trained"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_throw_expert"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_throw_master"
                  />
                </td>
                <td>
                  <button
                    type="roll"
                    value="&{template:general} {{character_name=@{character_name}}} {{roll_title=@{throw_name}}} {{target=[[?{Bonus/Malus|0} + @{throw_main_stat} - @{basic_skill_malus} + @{throw_trained} * @{basic_skill_malus} + @{throw_expert} * (floor(@{throw_bonus_stat} / 10) * @{expert_skill_multiplier}) + @{throw_master} * (floor(@{throw_bonus_stat} / 10) * @{master_skill_multiplier})]]}} {{roll=[[1D100cs<5cf>96]]}}"
                  ></button>
                </td>
              </tr>
              <tr class="skill">
                <td class="full-width">
                  <input
                    type="text"
                    class="full-width line-input"
                    name="attr_melee_name"
                    value="Armes de mêlée"
                    disabled
                  />
                </td>
                <td>
                  <input type="hidden" name="attr_melee_main_stat" value="@{phy_total}" />
                  <select disabled>
                    <option selected>PHY</option>
                  </select>
                </td>
                <td class="bonus"></td>
                <td>
                  <input type="hidden" name="attr_melee_bonus_stat" value="@{hab_total}" />
                  <select disabled>
                    <option selected>HAB</option>
                  </select>
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_melee_trained"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_melee_expert"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_melee_master"
                  />
                </td>
                <td>
                  <button
                    type="roll"
                    value="&{template:general} {{character_name=@{character_name}}} {{roll_title=@{melee_name}}} {{target=[[?{Bonus/Malus|0} + @{melee_main_stat} - @{basic_skill_malus} + @{melee_trained} * @{basic_skill_malus} + @{melee_expert} * (floor(@{melee_bonus_stat} / 10) * @{expert_skill_multiplier}) + @{melee_master} * (floor(@{melee_bonus_stat} / 10) * @{master_skill_multiplier})]]}} {{roll=[[1D100cs<5cf>96]]}}"
                  ></button>
                </td>
              </tr>
              <tr class="skill">
                <td class="full-width">
                  <input
                    type="text"
                    class="full-width line-input"
                    name="attr_ranged_name"
                    value="Armes de trait"
                    disabled
                  />
                </td>
                <td>
                  <input type="hidden" name="attr_ranged_main_stat" value="@{hab_total}" />
                  <select disabled>
                    <option selected>HAB</option>
                  </select>
                </td>
                <td class="bonus"></td>
                <td>
                  <input type="hidden" name="attr_ranged_bonus_stat" value="@{phy_total}" />
                  <select disabled>
                    <option selected>PHY</option>
                  </select>
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_ranged_trained"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_ranged_expert"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_ranged_master"
                  />
                </td>
                <td>
                  <button
                    type="roll"
                    value="&{template:general} {{character_name=@{character_name}}} {{roll_title=@{ranged_name}}} {{target=[[?{Bonus/Malus|0} + @{ranged_main_stat} - @{basic_skill_malus} + @{ranged_trained} * @{basic_skill_malus} + @{ranged_expert} * (floor(@{ranged_bonus_stat} / 10) * @{expert_skill_multiplier}) + @{ranged_master} * (floor(@{ranged_bonus_stat} / 10) * @{master_skill_multiplier})]]}} {{roll=[[1D100cs<5cf>96]]}}"
                  ></button>
                </td>
              </tr>
              <tr class="skill">
                <td class="full-width">
                  <input
                    type="text"
                    class="full-width line-input"
                    name="attr_athl_name"
                    value="Athlétisme"
                    disabled
                  />
                </td>
                <td>
                  <input type="hidden" name="attr_athl_main_stat" value="@{phy_total}" />
                  <select disabled>
                    <option selected>PHY</option>
                  </select>
                </td>
                <td class="bonus"></td>
                <td>
                  <input type="hidden" name="attr_athl_bonus_stat" value="@{agi_total}" />
                  <select disabled>
                    <option selected>AGI</option>
                  </select>
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_athl_trained"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_athl_expert"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_athl_master"
                  />
                </td>
                <td>
                  <button
                    type="roll"
                    value="&{template:general} {{character_name=@{character_name}}} {{roll_title=@{athl_name}}} {{target=[[?{Bonus/Malus|0} + @{athl_main_stat} - @{basic_skill_malus} + @{athl_trained} * @{basic_skill_malus} + @{athl_expert} * (floor(@{athl_bonus_stat} / 10) * @{expert_skill_multiplier}) + @{athl_master} * (floor(@{athl_bonus_stat} / 10) * @{master_skill_multiplier})]]}} {{roll=[[1D100cs<5cf>96]]}}"
                  ></button>
                </td>
              </tr>
              <tr class="skill">
                <td class="full-width">
                  <input
                    type="text"
                    class="full-width line-input"
                    name="attr_decep_name"
                    value="Baratin"
                    disabled
                  />
                </td>
                <td>
                  <input type="hidden" name="attr_decep_main_stat" value="@{cha_total}" />
                  <select disabled>
                    <option selected>CHA</option>
                  </select>
                </td>
                <td class="bonus"></td>
                <td>
                  <input type="hidden" name="attr_decep_bonus_stat" value="@{int_total}" />
                  <select disabled>
                    <option selected>INT</option>
                  </select>
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_decep_trained"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_decep_expert"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_decep_master"
                  />
                </td>
                <td>
                  <button
                    type="roll"
                    value="&{template:general} {{character_name=@{character_name}}} {{roll_title=@{decep_name}}} {{target=[[?{Bonus/Malus|0} + @{decep_main_stat} - @{basic_skill_malus} + @{decep_trained} * @{basic_skill_malus} + @{decep_expert} * (floor(@{decep_bonus_stat} / 10) * @{expert_skill_multiplier}) + @{decep_master} * (floor(@{decep_bonus_stat} / 10) * @{master_skill_multiplier})]]}} {{roll=[[1D100cs<5cf>96]]}}"
                  ></button>
                </td>
              </tr>
              <tr class="skill">
                <td class="full-width">
                  <input
                    type="text"
                    class="full-width line-input"
                    name="attr_tinker_name"
                    value="Bricolage"
                    disabled
                  />
                </td>
                <td>
                  <input type="hidden" name="attr_tinker_main_stat" value="@{hab_total}" />
                  <select disabled>
                    <option selected>HAB</option>
                  </select>
                </td>
                <td class="bonus"></td>
                <td>
                  <input type="hidden" name="attr_tinker_bonus_stat" value="@{int_total}" />
                  <select disabled>
                    <option selected>INT</option>
                  </select>
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_tinker_trained"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_tinker_expert"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_tinker_master"
                  />
                </td>
                <td>
                  <button
                    type="roll"
                    value="&{template:general} {{character_name=@{character_name}}} {{roll_title=@{tinker_name}}} {{target=[[?{Bonus/Malus|0} + @{tinker_main_stat} - @{basic_skill_malus} + @{tinker_trained} * @{basic_skill_malus} + @{tinker_expert} * (floor(@{tinker_bonus_stat} / 10) * @{expert_skill_multiplier}) + @{tinker_master} * (floor(@{tinker_bonus_stat} / 10) * @{master_skill_multiplier})]]}} {{roll=[[1D100cs<5cf>96]]}}"
                  ></button>
                </td>
              </tr>
              <tr class="skill">
                <td class="full-width">
                  <input
                    type="text"
                    class="full-width line-input"
                    name="attr_charm_name"
                    value="Charme"
                    disabled
                  />
                </td>
                <td>
                  <input type="hidden" name="attr_charm_main_stat" value="@{cha_total}" />
                  <select disabled>
                    <option selected>CHA</option>
                  </select>
                </td>
                <td class="bonus"></td>
                <td>
                  <input type="hidden" name="attr_charm_bonus_stat" value="@{emp_total}" />
                  <select disabled>
                    <option selected>EMP</option>
                  </select>
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_charm_trained"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_charm_expert"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_charm_master"
                  />
                </td>
                <td>
                  <button
                    type="roll"
                    value="&{template:general} {{character_name=@{character_name}}} {{roll_title=@{charm_name}}} {{target=[[?{Bonus/Malus|0} + @{charm_main_stat} - @{basic_skill_malus} + @{charm_trained} * @{basic_skill_malus} + @{charm_expert} * (floor(@{charm_bonus_stat} / 10) * @{expert_skill_multiplier}) + @{charm_master} * (floor(@{charm_bonus_stat} / 10) * @{master_skill_multiplier})]]}} {{roll=[[1D100cs<5cf>96]]}}"
                  ></button>
                </td>
              </tr>
              <tr class="skill">
                <td class="full-width">
                  <input
                    type="text"
                    class="full-width line-input"
                    name="attr_unarmed_name"
                    value="Corps-à-corps"
                    disabled
                  />
                </td>
                <td>
                  <input type="hidden" name="attr_unarmed_main_stat" value="@{phy_total}" />
                  <select disabled>
                    <option selected>PHY</option>
                  </select>
                </td>
                <td class="bonus"></td>
                <td>
                  <input type="hidden" name="attr_unarmed_bonus_stat" value="@{agi_total}" />
                  <select disabled>
                    <option selected>AGI</option>
                  </select>
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_unarmed_trained"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_unarmed_expert"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_unarmed_master"
                  />
                </td>
                <td>
                  <button
                    type="roll"
                    value="&{template:general} {{character_name=@{character_name}}} {{roll_title=@{unarmed_name}}} {{target=[[?{Bonus/Malus|0} + @{unarmed_main_stat} - @{basic_skill_malus} + @{unarmed_trained} * @{basic_skill_malus} + @{unarmed_expert} * (floor(@{unarmed_bonus_stat} / 10) * @{expert_skill_multiplier}) + @{unarmed_master} * (floor(@{unarmed_bonus_stat} / 10) * @{master_skill_multiplier})]]}} {{roll=[[1D100cs<5cf>96]]}}"
                  ></button>
                </td>
              </tr>
              <tr class="skill">
                <td class="full-width">
                  <input
                    type="text"
                    class="full-width line-input"
                    name="attr_stealth_name"
                    value="Dissimulation"
                    disabled
                  />
                </td>
                <td>
                  <input type="hidden" name="attr_stealth_main_stat" value="@{agi_total}" />
                  <select disabled>
                    <option selected>AGI</option>
                  </select>
                </td>
                <td class="bonus"></td>
                <td>
                  <input type="hidden" name="attr_stealth_bonus_stat" value="@{acu_total}" />
                  <select disabled>
                    <option selected>ACU</option>
                  </select>
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_stealth_trained"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_stealth_expert"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_stealth_master"
                  />
                </td>
                <td>
                  <button
                    type="roll"
                    value="&{template:general} {{character_name=@{character_name}}} {{roll_title=@{stealth_name}}} {{target=[[?{Bonus/Malus|0} + @{stealth_main_stat} - @{basic_skill_malus} + @{stealth_trained} * @{basic_skill_malus} + @{stealth_expert} * (floor(@{stealth_bonus_stat} / 10) * @{expert_skill_multiplier}) + @{stealth_master} * (floor(@{stealth_bonus_stat} / 10) * @{master_skill_multiplier})]]}} {{roll=[[1D100cs<5cf>96]]}}"
                  ></button>
                </td>
              </tr>
              <tr class="skill">
                <td class="full-width">
                  <input
                    type="text"
                    class="full-width line-input"
                    name="attr_dodge_name"
                    value="Esquive"
                    disabled
                  />
                </td>
                <td>
                  <input type="hidden" name="attr_dodge_main_stat" value="@{agi_total}" />
                  <select disabled>
                    <option selected>AGI</option>
                  </select>
                </td>
                <td class="bonus"></td>
                <td>
                  <input type="hidden" name="attr_dodge_bonus_stat" value="@{acu_total}" />
                  <select disabled>
                    <option selected>ACU</option>
                  </select>
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_dodge_trained"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_dodge_expert"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_dodge_master"
                  />
                </td>
                <td>
                  <button
                    type="roll"
                    value="&{template:general} {{character_name=@{character_name}}} {{roll_title=@{dodge_name}}} {{target=[[?{Bonus/Malus|0} + @{dodge_main_stat} - @{basic_skill_malus} + @{dodge_trained} * @{basic_skill_malus} + @{dodge_expert} * (floor(@{dodge_bonus_stat} / 10) * @{expert_skill_multiplier}) + @{dodge_master} * (floor(@{dodge_bonus_stat} / 10) * @{master_skill_multiplier})]]}} {{roll=[[1D100cs<5cf>96]]}}"
                  ></button>
                </td>
              </tr>
              <tr class="skill">
                <td class="full-width">
                  <input
                    type="text"
                    class="full-width line-input"
                    name="attr_threat_name"
                    value="Intimidation"
                    disabled
                  />
                </td>
                <td>
                  <input type="hidden" name="attr_threat_main_stat" value="@{cha_total}" />
                  <select disabled>
                    <option selected>CHA</option>
                  </select>
                </td>
                <td class="bonus"></td>
                <td>
                  <input type="hidden" name="attr_threat_bonus_stat" value="@{wil_total}" />
                  <select disabled>
                    <option selected>VOL</option>
                  </select>
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_threat_trained"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_threat_expert"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_threat_master"
                  />
                </td>
                <td>
                  <button
                    type="roll"
                    value="&{template:general} {{character_name=@{character_name}}} {{roll_title=@{threat_name}}} {{target=[[?{Bonus/Malus|0} + @{threat_main_stat} - @{basic_skill_malus} + @{threat_trained} * @{basic_skill_malus} + @{threat_expert} * (floor(@{threat_bonus_stat} / 10) * @{expert_skill_multiplier}) + @{threat_master} * (floor(@{threat_bonus_stat} / 10) * @{master_skill_multiplier})]]}} {{roll=[[1D100cs<5cf>96]]}}"
                  ></button>
                </td>
              </tr>
              <tr class="skill">
                <td class="full-width">
                  <input
                    type="text"
                    class="full-width line-input"
                    name="attr_parry_name"
                    value="Parade"
                    disabled
                  />
                </td>
                <td>
                  <input type="hidden" name="attr_parry_main_stat" value="@{phy_total}" />
                  <select disabled>
                    <option selected>PHY</option>
                  </select>
                </td>
                <td class="bonus"></td>
                <td>
                  <input type="hidden" name="attr_parry_bonus_stat" value="@{agi_total}" />
                  <select disabled>
                    <option selected>AGI</option>
                  </select>
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_parry_trained"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_parry_expert"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_parry_master"
                  />
                </td>
                <td>
                  <button
                    type="roll"
                    value="&{template:general} {{character_name=@{character_name}}} {{roll_title=@{parry_name}}} {{target=[[?{Bonus/Malus|0} + @{parry_main_stat} - @{basic_skill_malus} + @{parry_trained} * @{basic_skill_malus} + @{parry_expert} * (floor(@{parry_bonus_stat} / 10) * @{expert_skill_multiplier}) + @{parry_master} * (floor(@{parry_bonus_stat} / 10) * @{master_skill_multiplier})]]}} {{roll=[[1D100cs<5cf>96]]}}"
                  ></button>
                </td>
              </tr>
              <tr class="skill">
                <td class="full-width">
                  <input
                    type="text"
                    class="full-width line-input"
                    name="attr_percep_name"
                    value="Perception"
                    disabled
                  />
                </td>
                <td>
                  <input type="hidden" name="attr_percep_main_stat" value="@{acu_total}" />
                  <select disabled>
                    <option selected>ACU</option>
                  </select>
                </td>
                <td class="bonus"></td>
                <td>
                  <input type="hidden" name="attr_percep_bonus_stat" value="@{int_total}" />
                  <select disabled>
                    <option selected>INT</option>
                  </select>
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_percep_trained"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_percep_expert"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_percep_master"
                  />
                </td>
                <td>
                  <button
                    type="roll"
                    value="&{template:general} {{character_name=@{character_name}}} {{roll_title=@{percep_name}}} {{target=[[?{Bonus/Malus|0} + @{percep_main_stat} - @{basic_skill_malus} + @{percep_trained} * @{basic_skill_malus} + @{percep_expert} * (floor(@{percep_bonus_stat} / 10) * @{expert_skill_multiplier}) + @{percep_master} * (floor(@{percep_bonus_stat} / 10) * @{master_skill_multiplier})]]}} {{roll=[[1D100cs<5cf>96]]}}"
                  ></button>
                </td>
              </tr>
              <tr class="skill">
                <td class="full-width">
                  <input
                    type="text"
                    class="full-width line-input"
                    name="attr_firstaid_name"
                    value="Premiers soins"
                    disabled
                  />
                </td>
                <td>
                  <input type="hidden" name="attr_firstaid_main_stat" value="@{hab_total}" />
                  <select disabled>
                    <option selected>HAB</option>
                  </select>
                </td>
                <td class="bonus"></td>
                <td>
                  <input type="hidden" name="attr_firstaid_bonus_stat" value="@{int_total}" />
                  <select disabled>
                    <option selected>INT</option>
                  </select>
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_firstaid_trained"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_firstaid_expert"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_firstaid_master"
                  />
                </td>
                <td>
                  <button
                    type="roll"
                    value="&{template:general} {{character_name=@{character_name}}} {{roll_title=@{firstaid_name}}} {{target=[[?{Bonus/Malus|0} + @{firstaid_main_stat} - @{basic_skill_malus} + @{firstaid_trained} * @{basic_skill_malus} + @{firstaid_expert} * (floor(@{firstaid_bonus_stat} / 10) * @{expert_skill_multiplier}) + @{firstaid_master} * (floor(@{firstaid_bonus_stat} / 10) * @{master_skill_multiplier})]]}} {{roll=[[1D100cs<5cf>96]]}}"
                  ></button>
                </td>
              </tr>
              <tr class="skill">
                <td class="full-width">
                  <input
                    type="text"
                    class="full-width line-input"
                    name="attr_researching_name"
                    value="Recherche"
                    disabled
                  />
                </td>
                <td>
                  <input type="hidden" name="attr_researching_main_stat" value="@{int_total}" />
                  <select disabled>
                    <option selected>INT</option>
                  </select>
                </td>
                <td class="bonus"></td>
                <td>
                  <input type="hidden" name="attr_researching_bonus_stat" value="@{wil_total}" />
                  <select disabled>
                    <option selected>VOL</option>
                  </select>
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_researching_trained"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_researching_expert"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_researching_master"
                  />
                </td>
                <td>
                  <button
                    type="roll"
                    value="&{template:general} {{character_name=@{character_name}}} {{roll_title=@{researching_name}}} {{target=[[?{Bonus/Malus|0} + @{researching_main_stat} - @{basic_skill_malus} + @{researching_trained} * @{basic_skill_malus} + @{researching_expert} * (floor(@{researching_bonus_stat} / 10) * @{expert_skill_multiplier}) + @{researching_master} * (floor(@{researching_bonus_stat} / 10) * @{master_skill_multiplier})]]}} {{roll=[[1D100cs<5cf>96]]}}"
                  ></button>
                </td>
              </tr>
              <tr class="skill">
                <td class="full-width">
                  <input
                    type="text"
                    class="full-width line-input"
                    name="attr_vigilance_name"
                    value="Vigilance"
                    disabled
                  />
                </td>
                <td>
                  <input type="hidden" name="attr_vigilance_main_stat" value="@{acu_total}" />
                  <select disabled>
                    <option selected>ACU</option>
                  </select>
                </td>
                <td class="bonus"></td>
                <td>
                  <input type="hidden" name="attr_vigilance_bonus_stat" value="@{vol_total}" />
                  <select disabled>
                    <option selected>VOL</option>
                  </select>
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_vigilance_trained"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_vigilance_expert"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_vigilance_master"
                  />
                </td>
                <td>
                  <button
                    type="roll"
                    value="&{template:general} {{character_name=@{character_name}}} {{roll_title=@{vigilance_name}}} {{target=[[?{Bonus/Malus|0} + @{vigilance_main_stat} - @{basic_skill_malus} + @{vigilance_trained} * @{basic_skill_malus} + @{vigilance_expert} * (floor(@{vigilance_bonus_stat} / 10) * @{expert_skill_multiplier}) + @{vigilance_master} * (floor(@{vigilance_bonus_stat} / 10) * @{master_skill_multiplier})]]}} {{roll=[[1D100cs<5cf>96]]}}"
                  ></button>
                </td>
              </tr>
            </tbody>
          </table>

          <!-- Piloting skills -->
          <table class="skills full-width">
            <thead>
              <tr>
                <th colspan="8">
                  <div class="table-title">Pilotage</div>
                </th>
              </tr>
              <tr>
                <th>Nom</th>
                <th>1.</th>
                <th></th>
                <th>2.</th>
                <th class="trained"></th>
                <th class="expert"></th>
                <th class="master"></th>
                <th></th>
              </tr>
            </thead>
            <tbody>
              <tr class="skill">
                <td class="full-width">
                  <input
                    type="text"
                    class="full-width line-input"
                    name="attr_piloting_name_1"
                    placeholder="Type de pilotage"
                    value=""
                  />
                </td>
                <td>
                  <input type="hidden" name="attr_piloting_main_stat" value="@{acu_total}" />
                  <select disabled>
                    <option selected>ACU</option>
                  </select>
                </td>
                <td class="bonus"></td>
                <td>
                  <input type="hidden" name="attr_piloting_bonus_stat" value="@{hab_total}" />
                  <select disabled>
                    <option selected>HAB</option>
                  </select>
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_piloting_1_trained"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_piloting_1_expert"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_piloting_1_master"
                  />
                </td>
                <td>
                  <button
                    type="roll"
                    value="&{template:general} {{character_name=@{character_name}}} {{roll_title=Pilotage (@{piloting_name_1})}} {{target=[[?{Bonus/Malus|0} + @{piloting_main_stat} - @{advanced_skill_malus} + @{piloting_1_trained} * @{advanced_skill_malus} + @{piloting_1_expert} * (floor(@{piloting_bonus_stat} / 10) * @{expert_skill_multiplier}) + @{piloting_1_master} * (floor(@{piloting_bonus_stat} / 10) * @{master_skill_multiplier})]]}} {{roll=[[1D100cs<5cf>96]]}}"
                  ></button>
                </td>
              </tr>
              <tr class="skill">
                <td class="full-width">
                  <input
                    type="text"
                    class="full-width line-input"
                    name="attr_piloting_name_2"
                    placeholder="Type de pilotage"
                    value=""
                  />
                </td>
                <td>
                  <input type="hidden" name="attr_piloting_main_stat" value="@{acu_total}" />
                  <select disabled>
                    <option selected>ACU</option>
                  </select>
                </td>
                <td class="bonus"></td>
                <td>
                  <input type="hidden" name="attr_piloting_bonus_stat" value="@{hab_total}" />
                  <select disabled>
                    <option selected>HAB</option>
                  </select>
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_piloting_2_trained"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_piloting_2_expert"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_piloting_2_master"
                  />
                </td>
                <td>
                  <button
                    type="roll"
                    value="&{template:general} {{character_name=@{character_name}}} {{roll_title=Pilotage (@{piloting_name_2})}} {{target=[[?{Bonus/Malus|0} + @{piloting_main_stat} - @{advanced_skill_malus} + @{piloting_2_trained} * @{advanced_skill_malus} + @{piloting_2_expert} * (floor(@{piloting_bonus_stat} / 10) * @{expert_skill_multiplier}) + @{piloting_2_master} * (floor(@{piloting_bonus_stat} / 10) * @{master_skill_multiplier})]]}} {{roll=[[1D100cs<5cf>96]]}}"
                  ></button>
                </td>
              </tr>
              <tr class="skill">
                <td class="full-width">
                  <input
                    type="text"
                    class="full-width line-input"
                    name="attr_piloting_name_3"
                    placeholder="Type de pilotage"
                    value=""
                  />
                </td>
                <td>
                  <input type="hidden" name="attr_piloting_main_stat" value="@{acu_total}" />
                  <select disabled>
                    <option selected>ACU</option>
                  </select>
                </td>
                <td class="bonus"></td>
                <td>
                  <input type="hidden" name="attr_piloting_bonus_stat" value="@{hab_total}" />
                  <select disabled>
                    <option selected>HAB</option>
                  </select>
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_piloting_3_trained"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_piloting_3_expert"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_piloting_3_master"
                  />
                </td>
                <td>
                  <button
                    type="roll"
                    value="&{template:general} {{character_name=@{character_name}}} {{roll_title=Pilotage (@{piloting_name_3})}} {{target=[[?{Bonus/Malus|0} + @{piloting_main_stat} - @{advanced_skill_malus} + @{piloting_3_trained} * @{advanced_skill_malus} + @{piloting_3_expert} * (floor(@{piloting_bonus_stat} / 10) * @{expert_skill_multiplier}) + @{piloting_3_master} * (floor(@{piloting_bonus_stat} / 10) * @{master_skill_multiplier})]]}} {{roll=[[1D100cs<5cf>96]]}}"
                  ></button>
                </td>
              </tr>
              <tr class="skill">
                <td class="full-width">
                  <input
                    type="text"
                    class="full-width line-input"
                    name="attr_piloting_name_4"
                    placeholder="Type de pilotage"
                    value=""
                  />
                </td>
                <td>
                  <input type="hidden" name="attr_piloting_main_stat" value="@{acu_total}" />
                  <select disabled>
                    <option selected>ACU</option>
                  </select>
                </td>
                <td class="bonus"></td>
                <td>
                  <input type="hidden" name="attr_piloting_bonus_stat" value="@{hab_total}" />
                  <select disabled>
                    <option selected>HAB</option>
                  </select>
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_piloting_4_trained"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_piloting_4_expert"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_piloting_4_master"
                  />
                </td>
                <td>
                  <button
                    type="roll"
                    value="&{template:general} {{character_name=@{character_name}}} {{roll_title=Pilotage (@{piloting_name_4})}} {{target=[[?{Bonus/Malus|0} + @{piloting_main_stat} - @{advanced_skill_malus} + @{piloting_4_trained} * @{advanced_skill_malus} + @{piloting_4_expert} * (floor(@{piloting_bonus_stat} / 10) * @{expert_skill_multiplier}) + @{piloting_4_master} * (floor(@{piloting_bonus_stat} / 10) * @{master_skill_multiplier})]]}} {{roll=[[1D100cs<5cf>96]]}}"
                  ></button>
                </td>
              </tr>
              <tr class="skill">
                <td class="full-width">
                  <input
                    type="text"
                    class="full-width line-input"
                    name="attr_piloting_name_5"
                    placeholder="Type de pilotage"
                    value=""
                  />
                </td>
                <td>
                  <input type="hidden" name="attr_piloting_main_stat" value="@{acu_total}" />
                  <select disabled>
                    <option selected>ACU</option>
                  </select>
                </td>
                <td class="bonus"></td>
                <td>
                  <input type="hidden" name="attr_piloting_bonus_stat" value="@{hab_total}" />
                  <select disabled>
                    <option selected>HAB</option>
                  </select>
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_piloting_5_trained"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_piloting_5_expert"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_piloting_5_master"
                  />
                </td>
                <td>
                  <button
                    type="roll"
                    value="&{template:general} {{character_name=@{character_name}}} {{roll_title=Pilotage (@{piloting_name_5})}} {{target=[[?{Bonus/Malus|0} + @{piloting_main_stat} - @{advanced_skill_malus} + @{piloting_5_trained} * @{advanced_skill_malus} + @{piloting_5_expert} * (floor(@{piloting_bonus_stat} / 10) * @{expert_skill_multiplier}) + @{piloting_5_master} * (floor(@{piloting_bonus_stat} / 10) * @{master_skill_multiplier})]]}} {{roll=[[1D100cs<5cf>96]]}}"
                  ></button>
                </td>
              </tr>
              <tr class="skill">
                <td class="full-width">
                  <input
                    type="text"
                    class="full-width line-input"
                    name="attr_piloting_name_6"
                    placeholder="Type de pilotage"
                    value=""
                  />
                </td>
                <td>
                  <input type="hidden" name="attr_piloting_main_stat" value="@{acu_total}" />
                  <select disabled>
                    <option selected>ACU</option>
                  </select>
                </td>
                <td class="bonus"></td>
                <td>
                  <input type="hidden" name="attr_piloting_bonus_stat" value="@{hab_total}" />
                  <select disabled>
                    <option selected>HAB</option>
                  </select>
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_piloting_6_trained"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_piloting_6_expert"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_piloting_6_master"
                  />
                </td>
                <td>
                  <button
                    type="roll"
                    value="&{template:general} {{character_name=@{character_name}}} {{roll_title=Pilotage (@{piloting_name_6})}} {{target=[[?{Bonus/Malus|0} + @{piloting_main_stat} - @{advanced_skill_malus} + @{piloting_6_trained} * @{advanced_skill_malus} + @{piloting_6_expert} * (floor(@{piloting_bonus_stat} / 10) * @{expert_skill_multiplier}) + @{piloting_6_master} * (floor(@{piloting_bonus_stat} / 10) * @{master_skill_multiplier})]]}} {{roll=[[1D100cs<5cf>96]]}}"
                  ></button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="half-width flex-col">

          <!-- Advanced skills -->
          <table class="skills full-width">
            <thead>
              <tr>
                <th colspan="8">
                  <div class="table-title">Compétences avancées</div>
                </th>
              </tr>
              <tr>
                <th>Nom</th>
                <th>1.</th>
                <th></th>
                <th>2.</th>
                <th class="trained"></th>
                <th class="expert"></th>
                <th class="master"></th>
                <th></th>
              </tr>
            </thead>
            <tbody>
              <tr class="skill">
                <td class="full-width">
                  <input
                    type="text"
                    class="full-width line-input"
                    name="attr_heavy_name"
                    value="Armes lourdes"
                    disabled
                  />
                </td>
                <td>
                  <input type="hidden" name="attr_heavy_main_stat" value="@{acu_total}" />
                  <select disabled>
                    <option selected>ACU</option>
                  </select>
                </td>
                <td class="bonus"></td>
                <td>
                  <input type="hidden" name="attr_heavy_bonus_stat" value="@{hab_total}" />
                  <select disabled>
                    <option selected>HAB</option>
                  </select>
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_heavy_trained"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_heavy_expert"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_heavy_master"
                  />
                </td>
                <td>
                  <button
                    type="roll"
                    value="&{template:general} {{character_name=@{character_name}}} {{roll_title=@{heavy_name}}} {{target=[[?{Bonus/Malus|0} + @{heavy_main_stat} - @{advanced_skill_malus} + @{heavy_trained} * @{advanced_skill_malus} + @{heavy_expert} * (floor(@{heavy_bonus_stat} / 10) * @{expert_skill_multiplier}) + @{heavy_master} * (floor(@{heavy_bonus_stat} / 10) * @{master_skill_multiplier})]]}} {{roll=[[1D100cs<5cf>96]]}}"
                  ></button>
                </td>
              </tr>
              <tr class="skill">
                <td class="full-width">
                  <input
                    type="text"
                    class="full-width line-input"
                    name="attr_chemistry_name"
                    value="Chimie"
                    disabled
                  />
                </td>
                <td>
                  <input type="hidden" name="attr_chemistry_main_stat" value="@{int_total}" />
                  <select disabled>
                    <option selected>INT</option>
                  </select>
                </td>
                <td class="bonus"></td>
                <td>
                  <input type="hidden" name="attr_chemistry_bonus_stat" value="@{vol_total}" />
                  <select disabled>
                    <option selected>VOL</option>
                  </select>
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_chemistry_trained"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_chemistry_expert"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_chemistry_master"
                  />
                </td>
                <td>
                  <button
                    type="roll"
                    value="&{template:general} {{character_name=@{character_name}}} {{roll_title=@{chemistry_name}}} {{target=[[?{Bonus/Malus|0} + @{chemistry_main_stat} - @{advanced_skill_malus} + @{chemistry_trained} * @{advanced_skill_malus} + @{chemistry_expert} * (floor(@{chemistry_bonus_stat} / 10) * @{expert_skill_multiplier}) + @{chemistry_master} * (floor(@{chemistry_bonus_stat} / 10) * @{master_skill_multiplier})]]}} {{roll=[[1D100cs<5cf>96]]}}"
                  ></button>
                </td>
              </tr>
              <tr class="skill">
                <td class="full-width">
                  <input
                    type="text"
                    class="full-width line-input"
                    name="attr_surgery_name"
                    value="Chirurgie"
                    disabled
                  />
                </td>
                <td>
                  <input type="hidden" name="attr_surgery_main_stat" value="@{int_total}" />
                  <select disabled>
                    <option selected>INT</option>
                  </select>
                </td>
                <td class="bonus"></td>
                <td>
                  <input type="hidden" name="attr_surgery_bonus_stat" value="@{hab_total}" />
                  <select disabled>
                    <option selected>HAB</option>
                  </select>
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_surgery_trained"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_surgery_expert"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_surgery_master"
                  />
                </td>
                <td>
                  <button
                    type="roll"
                    value="&{template:general} {{character_name=@{character_name}}} {{roll_title=@{surgery_name}}} {{target=[[?{Bonus/Malus|0} + @{surgery_main_stat} - @{advanced_skill_malus} + @{surgery_trained} * @{advanced_skill_malus} + @{surgery_expert} * (floor(@{surgery_bonus_stat} / 10) * @{expert_skill_multiplier}) + @{surgery_master} * (floor(@{surgery_bonus_stat} / 10) * @{master_skill_multiplier})]]}} {{roll=[[1D100cs<5cf>96]]}}"
                  ></button>
                </td>
              </tr>
              <tr class="skill">
                <td class="full-width">
                  <input
                    type="text"
                    class="full-width line-input"
                    name="attr_lockpicking_name"
                    value="Crochetage"
                    disabled
                  />
                </td>
                <td>
                  <input type="hidden" name="attr_lockpicking_main_stat" value="@{hab_total}" />
                  <select disabled>
                    <option selected>HAB</option>
                  </select>
                </td>
                <td class="bonus"></td>
                <td>
                  <input type="hidden" name="attr_lockpicking_bonus_stat" value="@{acu_total}" />
                  <select disabled>
                    <option selected>ACU</option>
                  </select>
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_lockpicking_trained"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_lockpicking_expert"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_lockpicking_master"
                  />
                </td>
                <td>
                  <button
                    type="roll"
                    value="&{template:general} {{character_name=@{character_name}}} {{roll_title=@{lockpicking_name}}} {{target=[[?{Bonus/Malus|0} + @{lockpicking_main_stat} - @{advanced_skill_malus} + @{lockpicking_trained} * @{advanced_skill_malus} + @{lockpicking_expert} * (floor(@{lockpicking_bonus_stat} / 10) * @{expert_skill_multiplier}) + @{lockpicking_master} * (floor(@{lockpicking_bonus_stat} / 10) * @{master_skill_multiplier})]]}} {{roll=[[1D100cs<5cf>96]]}}"
                  ></button>
                </td>
              </tr>
              <tr class="skill">
                <td class="full-width">
                  <input
                    type="text"
                    class="full-width line-input"
                    name="attr_demolition_name"
                    value="Démolition"
                    disabled
                  />
                </td>
                <td>
                  <input type="hidden" name="attr_demolition_main_stat" value="@{acu_total}" />
                  <select disabled>
                    <option selected>ACU</option>
                  </select>
                </td>
                <td class="bonus"></td>
                <td>
                  <input type="hidden" name="attr_demolition_bonus_stat" value="@{wil_total}" />
                  <select disabled>
                    <option selected>VOL</option>
                  </select>
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_demolition_trained"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_demolition_expert"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_demolition_master"
                  />
                </td>
                <td>
                  <button
                    type="roll"
                    value="&{template:general} {{character_name=@{character_name}}} {{roll_title=@{demolition_name}}} {{target=[[?{Bonus/Malus|0} + @{demolition_main_stat} - @{advanced_skill_malus} + @{demolition_trained} * @{advanced_skill_malus} + @{demolition_expert} * (floor(@{demolition_bonus_stat} / 10) * @{expert_skill_multiplier}) + @{demolition_master} * (floor(@{demolition_bonus_stat} / 10) * @{master_skill_multiplier})]]}} {{roll=[[1D100cs<5cf>96]]}}"
                  ></button>
                </td>
              </tr>
              <tr class="skill">
                <td class="full-width">
                  <input
                    type="text"
                    class="full-width line-input"
                    name="attr_informatics_name"
                    value="Informatique"
                    disabled
                  />
                </td>
                <td>
                  <input type="hidden" name="attr_informatics_main_stat" value="@{int_total}" />
                  <select disabled>
                    <option selected>INT</option>
                  </select>
                </td>
                <td class="bonus"></td>
                <td>
                  <input type="hidden" name="attr_informatics_bonus_stat" value="@{wil_total}" />
                  <select disabled>
                    <option selected>VOL</option>
                  </select>
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_informatics_trained"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_informatics_expert"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_informatics_master"
                  />
                </td>
                <td>
                  <button
                    type="roll"
                    value="&{template:general} {{character_name=@{character_name}}} {{roll_title=@{informatics_name}}} {{target=[[?{Bonus/Malus|0} + @{informatics_main_stat} - @{advanced_skill_malus} + @{informatics_trained} * @{advanced_skill_malus} + @{informatics_expert} * (floor(@{informatics_bonus_stat} / 10) * @{expert_skill_multiplier}) + @{informatics_master} * (floor(@{informatics_bonus_stat} / 10) * @{master_skill_multiplier})]]}} {{roll=[[1D100cs<5cf>96]]}}"
                  ></button>
                </td>
              </tr>
              <tr class="skill">
                <td class="full-width">
                  <input
                    type="text"
                    class="full-width line-input"
                    name="attr_linguistics_name"
                    value="Linguistique"
                    disabled
                  />
                </td>
                <td>
                  <input type="hidden" name="attr_linguistics_main_stat" value="@{int_total}" />
                  <select disabled>
                    <option selected>INT</option>
                  </select>
                </td>
                <td class="bonus"></td>
                <td>
                  <input type="hidden" name="attr_linguistics_bonus_stat" value="@{int_total}" />
                  <select disabled>
                    <option selected>INT</option>
                  </select>
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_linguistics_trained"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_linguistics_expert"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_linguistics_master"
                  />
                </td>
                <td>
                  <button
                    type="roll"
                    value="&{template:general} {{character_name=@{character_name}}} {{roll_title=@{linguistics_name}}} {{target=[[?{Bonus/Malus|0} + @{linguistics_main_stat} - @{advanced_skill_malus} + @{linguistics_trained} * @{advanced_skill_malus} + @{linguistics_expert} * (floor(@{linguistics_bonus_stat} / 10) * @{expert_skill_multiplier}) + @{linguistics_master} * (floor(@{linguistics_bonus_stat} / 10) * @{master_skill_multiplier})]]}} {{roll=[[1D100cs<5cf>96]]}}"
                  ></button>
                </td>
              </tr>
              <tr class="skill">
                <td class="full-width">
                  <input
                    type="text"
                    class="full-width line-input"
                    name="attr_mechanics_name"
                    value="Mécanique"
                    disabled
                  />
                </td>
                <td>
                  <input type="hidden" name="attr_mechanics_main_stat" value="@{hab_total}" />
                  <select disabled>
                    <option selected>HAB</option>
                  </select>
                </td>
                <td class="bonus"></td>
                <td>
                  <input type="hidden" name="attr_mechanics_bonus_stat" value="@{int_total}" />
                  <select disabled>
                    <option selected>INT</option>
                  </select>
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_mechanics_trained"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_mechanics_expert"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_mechanics_master"
                  />
                </td>
                <td>
                  <button
                    type="roll"
                    value="&{template:general} {{character_name=@{character_name}}} {{roll_title=@{mechanics_name}}} {{target=[[?{Bonus/Malus|0} + @{mechanics_main_stat} - @{advanced_skill_malus} + @{mechanics_trained} * @{advanced_skill_malus} + @{mechanics_expert} * (floor(@{mechanics_bonus_stat} / 10) * @{expert_skill_multiplier}) + @{mechanics_master} * (floor(@{mechanics_bonus_stat} / 10) * @{master_skill_multiplier})]]}} {{roll=[[1D100cs<5cf>96]]}}"
                  ></button>
                </td>
              </tr>
              <tr class="skill">
                <td class="full-width">
                  <input
                    type="text"
                    class="full-width line-input"
                    name="attr_medic_name"
                    value="Médecine"
                    disabled
                  />
                </td>
                <td>
                  <input type="hidden" name="attr_medic_main_stat" value="@{int_total}" />
                  <select disabled>
                    <option selected>INT</option>
                  </select>
                </td>
                <td class="bonus"></td>
                <td>
                  <input type="hidden" name="attr_medic_bonus_stat" value="@{int_total}" />
                  <select disabled>
                    <option selected>INT</option>
                  </select>
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_medic_trained"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_medic_expert"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_medic_master"
                  />
                </td>
                <td>
                  <button
                    type="roll"
                    value="&{template:general} {{character_name=@{character_name}}} {{roll_title=@{medic_name}}} {{target=[[?{Bonus/Malus|0} + @{medic_main_stat} - @{advanced_skill_malus} + @{medic_trained} * @{advanced_skill_malus} + @{medic_expert} * (floor(@{medic_bonus_stat} / 10) * @{expert_skill_multiplier}) + @{medic_master} * (floor(@{medic_bonus_stat} / 10) * @{master_skill_multiplier})]]}} {{roll=[[1D100cs<5cf>96]]}}"
                  ></button>
                </td>
              </tr>
              <tr class="skill">
                <td class="full-width">
                  <input
                    type="text"
                    class="full-width line-input"
                    name="attr_psychology_name"
                    value="Psychologie"
                    disabled
                  />
                </td>
                <td>
                  <input type="hidden" name="attr_psychology_main_stat" value="@{emp_total}" />
                  <select disabled>
                    <option selected>EMP</option>
                  </select>
                </td>
                <td class="bonus"></td>
                <td>
                  <input type="hidden" name="attr_psychology_bonus_stat" value="@{int_total}" />
                  <select disabled>
                    <option selected>INT</option>
                  </select>
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_psychology_trained"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_psychology_expert"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_psychology_master"
                  />
                </td>
                <td>
                  <button
                    type="roll"
                    value="&{template:general} {{character_name=@{character_name}}} {{roll_title=@{psychology_name}}} {{target=[[?{Bonus/Malus|0} + @{psychology_main_stat} - @{advanced_skill_malus} + @{psychology_trained} * @{advanced_skill_malus} + @{psychology_expert} * (floor(@{psychology_bonus_stat} / 10) * @{expert_skill_multiplier}) + @{psychology_master} * (floor(@{psychology_bonus_stat} / 10) * @{master_skill_multiplier})]]}} {{roll=[[1D100cs<5cf>96]]}}"
                  ></button>
                </td>
              </tr>
            </tbody>
          </table>

          <!-- Knowledge skills -->
          <table class="skills full-width">
            <thead>
              <tr>
                <th colspan="8">
                  <div class="table-title">Connaissances</div>
                </th>
              </tr>
              <tr>
                <th>Nom</th>
                <th>1.</th>
                <th></th>
                <th>2.</th>
                <th class="trained"></th>
                <th class="expert"></th>
                <th class="master"></th>
                <th></th>
              </tr>
            </thead>
            <tbody>
              <tr class="skill">
                <td class="full-width">
                  <input
                    type="text"
                    class="full-width line-input"
                    name="attr_knowledge_name_1"
                    placeholder="Type de connaissance"
                    value=""
                  />
                </td>
                <td>
                  <input type="hidden" name="attr_knowledge_main_stat" value="@{int_total}" />
                  <select disabled>
                    <option selected>INT</option>
                  </select>
                </td>
                <td class="bonus"></td>
                <td>
                  <input type="hidden" name="attr_knowledge_bonus_stat" value="@{int_total}" />
                  <select disabled>
                    <option selected>INT</option>
                  </select>
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_knowledge_1_trained"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_knowledge_1_expert"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_knowledge_1_master"
                  />
                </td>
                <td>
                  <button
                    type="roll"
                    value="&{template:general} {{character_name=@{character_name}}} {{roll_title=Connaissance (@{knowledge_name_1})}} {{target=[[?{Bonus/Malus|0} + @{knowledge_main_stat} - @{advanced_skill_malus} + @{knowledge_1_trained} * @{advanced_skill_malus} + @{knowledge_1_expert} * (floor(@{knowledge_bonus_stat} / 10) * @{expert_skill_multiplier}) + @{knowledge_1_master} * (floor(@{knowledge_bonus_stat} / 10) * @{master_skill_multiplier})]]}} {{roll=[[1D100cs<5cf>96]]}}"
                  ></button>
                </td>
              </tr>
              <tr class="skill">
                <td class="full-width">
                  <input
                    type="text"
                    class="full-width line-input"
                    name="attr_knowledge_name_2"
                    placeholder="Type de connaissance"
                    value=""
                  />
                </td>
                <td>
                  <input type="hidden" name="attr_knowledge_main_stat" value="@{int_total}" />
                  <select disabled>
                    <option selected>INT</option>
                  </select>
                </td>
                <td class="bonus"></td>
                <td>
                  <input type="hidden" name="attr_knowledge_bonus_stat" value="@{int_total}" />
                  <select disabled>
                    <option selected>INT</option>
                  </select>
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_knowledge_2_trained"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_knowledge_2_expert"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_knowledge_2_master"
                  />
                </td>
                <td>
                  <button
                    type="roll"
                    value="&{template:general} {{character_name=@{character_name}}} {{roll_title=Connaissance (@{knowledge_name_2})}} {{target=[[?{Bonus/Malus|0} + @{knowledge_main_stat} - @{advanced_skill_malus} + @{knowledge_2_trained} * @{advanced_skill_malus} + @{knowledge_2_expert} * (floor(@{knowledge_bonus_stat} / 10) * @{expert_skill_multiplier}) + @{knowledge_2_master} * (floor(@{knowledge_bonus_stat} / 10) * @{master_skill_multiplier})]]}} {{roll=[[1D100cs<5cf>96]]}}"
                  ></button>
                </td>
              </tr>
              <tr class="skill">
                <td class="full-width">
                  <input
                    type="text"
                    class="full-width line-input"
                    name="attr_knowledge_name_3"
                    placeholder="Type de connaissance"
                    value=""
                  />
                </td>
                <td>
                  <input type="hidden" name="attr_knowledge_main_stat" value="@{int_total}" />
                  <select disabled>
                    <option selected>INT</option>
                  </select>
                </td>
                <td class="bonus"></td>
                <td>
                  <input type="hidden" name="attr_knowledge_bonus_stat" value="@{int_total}" />
                  <select disabled>
                    <option selected>INT</option>
                  </select>
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_knowledge_3_trained"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_knowledge_3_expert"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_knowledge_3_master"
                  />
                </td>
                <td>
                  <button
                    type="roll"
                    value="&{template:general} {{character_name=@{character_name}}} {{roll_title=Connaissance (@{knowledge_name_3})}} {{target=[[?{Bonus/Malus|0} + @{knowledge_main_stat} - @{advanced_skill_malus} + @{knowledge_3_trained} * @{advanced_skill_malus} + @{knowledge_3_expert} * (floor(@{knowledge_bonus_stat} / 10) * @{expert_skill_multiplier}) + @{knowledge_3_master} * (floor(@{knowledge_bonus_stat} / 10) * @{master_skill_multiplier})]]}} {{roll=[[1D100cs<5cf>96]]}}"
                  ></button>
                </td>
              </tr>
              <tr class="skill">
                <td class="full-width">
                  <input
                    type="text"
                    class="full-width line-input"
                    name="attr_knowledge_name_4"
                    placeholder="Type de connaissance"
                    value=""
                  />
                </td>
                <td>
                  <input type="hidden" name="attr_knowledge_main_stat" value="@{int_total}" />
                  <select disabled>
                    <option selected>INT</option>
                  </select>
                </td>
                <td class="bonus"></td>
                <td>
                  <input type="hidden" name="attr_knowledge_bonus_stat" value="@{int_total}" />
                  <select disabled>
                    <option selected>INT</option>
                  </select>
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_knowledge_4_trained"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_knowledge_4_expert"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_knowledge_4_master"
                  />
                </td>
                <td>
                  <button
                    type="roll"
                    value="&{template:general} {{character_name=@{character_name}}} {{roll_title=Connaissance (@{knowledge_name_4})}} {{target=[[?{Bonus/Malus|0} + @{knowledge_main_stat} - @{advanced_skill_malus} + @{knowledge_4_trained} * @{advanced_skill_malus} + @{knowledge_4_expert} * (floor(@{knowledge_bonus_stat} / 10) * @{expert_skill_multiplier}) + @{knowledge_4_master} * (floor(@{knowledge_bonus_stat} / 10) * @{master_skill_multiplier})]]}} {{roll=[[1D100cs<5cf>96]]}}"
                  ></button>
                </td>
              </tr>
              <tr class="skill">
                <td class="full-width">
                  <input
                    type="text"
                    class="full-width line-input"
                    name="attr_knowledge_name_5"
                    placeholder="Type de connaissance"
                    value=""
                  />
                </td>
                <td>
                  <input type="hidden" name="attr_knowledge_main_stat" value="@{int_total}" />
                  <select disabled>
                    <option selected>INT</option>
                  </select>
                </td>
                <td class="bonus"></td>
                <td>
                  <input type="hidden" name="attr_knowledge_bonus_stat" value="@{int_total}" />
                  <select disabled>
                    <option selected>INT</option>
                  </select>
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_knowledge_5_trained"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_knowledge_5_expert"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_knowledge_5_master"
                  />
                </td>
                <td>
                  <button
                    type="roll"
                    value="&{template:general} {{character_name=@{character_name}}} {{roll_title=Connaissance (@{knowledge_name_5})}} {{target=[[?{Bonus/Malus|0} + @{knowledge_main_stat} - @{advanced_skill_malus} + @{knowledge_5_trained} * @{advanced_skill_malus} + @{knowledge_5_expert} * (floor(@{knowledge_bonus_stat} / 10) * @{expert_skill_multiplier}) + @{knowledge_5_master} * (floor(@{knowledge_bonus_stat} / 10) * @{master_skill_multiplier})]]}} {{roll=[[1D100cs<5cf>96]]}}"
                  ></button>
                </td>
              </tr>
              <tr class="skill">
                <td class="full-width">
                  <input
                    type="text"
                    class="full-width line-input"
                    name="attr_knowledge_name_6"
                    placeholder="Type de connaissance"
                    value=""
                  />
                </td>
                <td>
                  <input type="hidden" name="attr_knowledge_main_stat" value="@{int_total}" />
                  <select disabled>
                    <option selected>INT</option>
                  </select>
                </td>
                <td class="bonus"></td>
                <td>
                  <input type="hidden" name="attr_knowledge_bonus_stat" value="@{int_total}" />
                  <select disabled>
                    <option selected>INT</option>
                  </select>
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_knowledge_6_trained"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_knowledge_6_expert"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_knowledge_6_master"
                  />
                </td>
                <td>
                  <button
                    type="roll"
                    value="&{template:general} {{character_name=@{character_name}}} {{roll_title=Connaissance (@{knowledge_name_6})}} {{target=[[?{Bonus/Malus|0} + @{knowledge_main_stat} - @{advanced_skill_malus} + @{knowledge_6_trained} * @{advanced_skill_malus} + @{knowledge_6_expert} * (floor(@{knowledge_bonus_stat} / 10) * @{expert_skill_multiplier}) + @{knowledge_6_master} * (floor(@{knowledge_bonus_stat} / 10) * @{master_skill_multiplier})]]}} {{roll=[[1D100cs<5cf>96]]}}"
                  ></button>
                </td>
              </tr>
              <tr class="skill">
                <td class="full-width">
                  <input
                    type="text"
                    class="full-width line-input"
                    name="attr_knowledge_name_7"
                    placeholder="Type de connaissance"
                    value=""
                  />
                </td>
                <td>
                  <input type="hidden" name="attr_knowledge_main_stat" value="@{int_total}" />
                  <select disabled>
                    <option selected>INT</option>
                  </select>
                </td>
                <td class="bonus"></td>
                <td>
                  <input type="hidden" name="attr_knowledge_bonus_stat" value="@{int_total}" />
                  <select disabled>
                    <option selected>INT</option>
                  </select>
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_knowledge_7_trained"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_knowledge_7_expert"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_knowledge_7_master"
                  />
                </td>
                <td>
                  <button
                    type="roll"
                    value="&{template:general} {{character_name=@{character_name}}} {{roll_title=Connaissance (@{knowledge_name_7})}} {{target=[[?{Bonus/Malus|0} + @{knowledge_main_stat} - @{advanced_skill_malus} + @{knowledge_7_trained} * @{advanced_skill_malus} + @{knowledge_7_expert} * (floor(@{knowledge_bonus_stat} / 10) * @{expert_skill_multiplier}) + @{knowledge_7_master} * (floor(@{knowledge_bonus_stat} / 10) * @{master_skill_multiplier})]]}} {{roll=[[1D100cs<5cf>96]]}}"
                  ></button>
                </td>
              </tr>
              <tr class="skill">
                <td class="full-width">
                  <input
                    type="text"
                    class="full-width line-input"
                    name="attr_knowledge_name_8"
                    placeholder="Type de connaissance"
                    value=""
                  />
                </td>
                <td>
                  <input type="hidden" name="attr_knowledge_main_stat" value="@{int_total}" />
                  <select disabled>
                    <option selected>INT</option>
                  </select>
                </td>
                <td class="bonus"></td>
                <td>
                  <input type="hidden" name="attr_knowledge_bonus_stat" value="@{int_total}" />
                  <select disabled>
                    <option selected>INT</option>
                  </select>
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_knowledge_8_trained"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_knowledge_8_expert"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_knowledge_8_master"
                  />
                </td>
                <td>
                  <button
                    type="roll"
                    value="&{template:general} {{character_name=@{character_name}}} {{roll_title=Connaissance (@{knowledge_name_8})}} {{target=[[?{Bonus/Malus|0} + @{knowledge_main_stat} - @{advanced_skill_malus} + @{knowledge_8_trained} * @{advanced_skill_malus} + @{knowledge_8_expert} * (floor(@{knowledge_bonus_stat} / 10) * @{expert_skill_multiplier}) + @{knowledge_8_master} * (floor(@{knowledge_bonus_stat} / 10) * @{master_skill_multiplier})]]}} {{roll=[[1D100cs<5cf>96]]}}"
                  ></button>
                </td>
              </tr>
              <tr class="skill">
                <td class="full-width">
                  <input
                    type="text"
                    class="full-width line-input"
                    name="attr_knowledge_name_9"
                    placeholder="Type de connaissance"
                    value=""
                  />
                </td>
                <td>
                  <input type="hidden" name="attr_knowledge_main_stat" value="@{int_total}" />
                  <select disabled>
                    <option selected>INT</option>
                  </select>
                </td>
                <td class="bonus"></td>
                <td>
                  <input type="hidden" name="attr_knowledge_bonus_stat" value="@{int_total}" />
                  <select disabled>
                    <option selected>INT</option>
                  </select>
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_knowledge_9_trained"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_knowledge_9_expert"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_knowledge_9_master"
                  />
                </td>
                <td>
                  <button
                    type="roll"
                    value="&{template:general} {{character_name=@{character_name}}} {{roll_title=Connaissance (@{knowledge_name_9})}} {{target=[[?{Bonus/Malus|0} + @{knowledge_main_stat} - @{advanced_skill_malus} + @{knowledge_9_trained} * @{advanced_skill_malus} + @{knowledge_9_expert} * (floor(@{knowledge_bonus_stat} / 10) * @{expert_skill_multiplier}) + @{knowledge_9_master} * (floor(@{knowledge_bonus_stat} / 10) * @{master_skill_multiplier})]]}} {{roll=[[1D100cs<5cf>96]]}}"
                  ></button>
                </td>
              </tr>
              <tr class="skill">
                <td class="full-width">
                  <input
                    type="text"
                    class="full-width line-input"
                    name="attr_knowledge_name_10"
                    placeholder="Type de connaissance"
                    value=""
                  />
                </td>
                <td>
                  <input type="hidden" name="attr_knowledge_main_stat" value="@{int_total}" />
                  <select disabled>
                    <option selected>INT</option>
                  </select>
                </td>
                <td class="bonus"></td>
                <td>
                  <input type="hidden" name="attr_knowledge_bonus_stat" value="@{int_total}" />
                  <select disabled>
                    <option selected>INT</option>
                  </select>
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_knowledge_10_trained"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_knowledge_10_expert"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_knowledge_10_master"
                  />
                </td>
                <td>
                  <button
                    type="roll"
                    value="&{template:general} {{character_name=@{character_name}}} {{roll_title=Connaissance (@{knowledge_name_10})}} {{target=[[?{Bonus/Malus|0} + @{knowledge_main_stat} - @{advanced_skill_malus} + @{knowledge_10_trained} * @{advanced_skill_malus} + @{knowledge_10_expert} * (floor(@{knowledge_bonus_stat} / 10) * @{expert_skill_multiplier}) + @{knowledge_10_master} * (floor(@{knowledge_bonus_stat} / 10) * @{master_skill_multiplier})]]}} {{roll=[[1D100cs<5cf>96]]}}"
                  ></button>
                </td>
              </tr>
              <tr class="skill">
                <td class="full-width">
                  <input
                    type="text"
                    class="full-width line-input"
                    name="attr_knowledge_name_11"
                    placeholder="Type de connaissance"
                    value=""
                  />
                </td>
                <td>
                  <input type="hidden" name="attr_knowledge_main_stat" value="@{int_total}" />
                  <select disabled>
                    <option selected>INT</option>
                  </select>
                </td>
                <td class="bonus"></td>
                <td>
                  <input type="hidden" name="attr_knowledge_bonus_stat" value="@{int_total}" />
                  <select disabled>
                    <option selected>INT</option>
                  </select>
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_knowledge_11_trained"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_knowledge_11_expert"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_knowledge_11_master"
                  />
                </td>
                <td>
                  <button
                    type="roll"
                    value="&{template:general} {{character_name=@{character_name}}} {{roll_title=Connaissance (@{knowledge_name_11})}} {{target=[[?{Bonus/Malus|0} + @{knowledge_main_stat} - @{advanced_skill_malus} + @{knowledge_11_trained} * @{advanced_skill_malus} + @{knowledge_11_expert} * (floor(@{knowledge_bonus_stat} / 11) * @{expert_skill_multiplier}) + @{knowledge_11_master} * (floor(@{knowledge_bonus_stat} / 11) * @{master_skill_multiplier})]]}} {{roll=[[1D112cs<5cf>96]]}}"
                  ></button>
                </td>
              </tr>
              <tr class="skill">
                <td class="full-width">
                  <input
                    type="text"
                    class="full-width line-input"
                    name="attr_knowledge_name_12"
                    placeholder="Type de connaissance"
                    value=""
                  />
                </td>
                <td>
                  <input type="hidden" name="attr_knowledge_main_stat" value="@{int_total}" />
                  <select disabled>
                    <option selected>INT</option>
                  </select>
                </td>
                <td class="bonus"></td>
                <td>
                  <input type="hidden" name="attr_knowledge_bonus_stat" value="@{int_total}" />
                  <select disabled>
                    <option selected>INT</option>
                  </select>
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_knowledge_12_trained"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_knowledge_12_expert"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_knowledge_12_master"
                  />
                </td>
                <td>
                  <button
                    type="roll"
                    value="&{template:general} {{character_name=@{character_name}}} {{roll_title=Connaissance (@{knowledge_name_12})}} {{target=[[?{Bonus/Malus|0} + @{knowledge_main_stat} - @{advanced_skill_malus} + @{knowledge_12_trained} * @{advanced_skill_malus} + @{knowledge_12_expert} * (floor(@{knowledge_bonus_stat} / 12) * @{expert_skill_multiplier}) + @{knowledge_12_master} * (floor(@{knowledge_bonus_stat} / 12) * @{master_skill_multiplier})]]}} {{roll=[[1D120cs<5cf>96]]}}"
                  ></button>
                </td>
              </tr>
              <tr class="skill">
                <td class="full-width">
                  <input
                    type="text"
                    class="full-width line-input"
                    name="attr_knowledge_name_13"
                    placeholder="Type de connaissance"
                    value=""
                  />
                </td>
                <td>
                  <input type="hidden" name="attr_knowledge_main_stat" value="@{int_total}" />
                  <select disabled>
                    <option selected>INT</option>
                  </select>
                </td>
                <td class="bonus"></td>
                <td>
                  <input type="hidden" name="attr_knowledge_bonus_stat" value="@{int_total}" />
                  <select disabled>
                    <option selected>INT</option>
                  </select>
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_knowledge_13_trained"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_knowledge_13_expert"
                  />
                </td>
                <td>
                  <input
                    type="checkbox"
                    value="1"
                    name="attr_knowledge_13_master"
                  />
                </td>
                <td>
                  <button
                    type="roll"
                    value="&{template:general} {{character_name=@{character_name}}} {{roll_title=Connaissance (@{knowledge_name_13})}} {{target=[[?{Bonus/Malus|0} + @{knowledge_main_stat} - @{advanced_skill_malus} + @{knowledge_13_trained} * @{advanced_skill_malus} + @{knowledge_13_expert} * (floor(@{knowledge_bonus_stat} / 13) * @{expert_skill_multiplier}) + @{knowledge_13_master} * (floor(@{knowledge_bonus_stat} / 13) * @{master_skill_multiplier})]]}} {{roll=[[1D130cs<5cf>96]]}}"
                  ></button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <!-- Protections tab -->
  <div class="tab flex-col full-width flex-middle protections">
    <div class="character-defenses flex-row full-width">
      <input type="hidden" name="attr_character_race" />
      <input type="hidden" name="attr_character_gender" />
      <div class="character-silhouette">

        <!-- Head -->
        <div class="character-location head">
          <input type="hidden" name="attr_head_protection_total" value="0" />
          <input
            disabled
            type="number"
            class="protection-total"
            name="attr_head_protection_display"
            value="@{head_protection_total}"
          />
          <input
            type="number"
            class="protection-bonus"
            name="attr_head_protection_bonus"
            value="0"
          />
        </div>

        <!-- Left arm -->
        <div class="character-location left-arm">
          <input type="hidden" name="attr_left_arm_protection_total" value="0" />
          <input
            disabled
            type="number"
            class="protection-total"
            name="attr_left_arm_protection_display"
            value="@{left_arm_protection_total}"
          />
          <input
            type="number"
            class="protection-bonus"
            name="attr_left_arm_protection_bonus"
            value="0"
          />
        </div>

        <!-- Right arm -->
        <div class="character-location right-arm">
          <input type="hidden" name="attr_right_arm_protection_total" value="0" />
          <input
            disabled
            type="number"
            class="protection-total"
            name="attr_right_arm_protection_display"
            value="@{right_arm_protection_total}"
          />
          <input
            type="number"
            class="protection-bonus"
            name="attr_right_arm_protection_bonus"
            value="0"
          />
        </div>

        <!-- Torso -->
        <div class="character-location torso">
          <input type="hidden" name="attr_torso_protection_total" value="0" />
          <input
            disabled
            type="number"
            class="protection-total"
            name="attr_torso_protection_display"
            value="@{torso_protection_total}"
          />
          <input
            type="number"
            class="protection-bonus"
            name="attr_torso_protection_bonus"
            value="0"
          />
        </div>

        <!-- Left leg -->
        <div class="character-location left-leg">
          <input type="hidden" name="attr_left_leg_protection_total" value="0" />
          <input
            disabled
            type="number"
            class="protection-total"
            name="attr_left_leg_protection_display"
            value="@{left_leg_protection_total}"
          />
          <input
            type="number"
            class="protection-bonus"
            name="attr_left_leg_protection_bonus"
            value="0"
          />
        </div>

        <!-- Right leg -->
        <div class="character-location right-leg">
          <input type="hidden" name="attr_right_leg_protection_total" value="0" />
          <input
            disabled
            type="number"
            class="protection-total"
            name="attr_right_leg_protection_display"
            value="@{right_leg_protection_total}"
          />
          <input
            type="number"
            class="protection-bonus"
            name="attr_right_leg_protection_bonus"
            value="0"
          />
        </div>
      </div>
      <div class="armors">
        <h2 class="tablet-title">Protections</h2>
        <fieldset class="repeating_armors">
          <div class="armor flex-col flex-width tablet-line">
            <div class="armor-details flex-row flex-middle full-width">
              <input
                type="text"
                name="attr_armor_name"
                class="full-width"
                placeholder="Nom de la protection"
              />
              <input
                type="number"
                name="attr_armor_weight"
                placeholder="0"
              />
              <div class="modif-wrapper">
                <input
                  type="checkbox"
                  name="attr_armor_is_expanded"
                  class="modif-toggle"
                  checked
                />
                <span></span>
              </div>
            </div>
            <input type="hidden" name="attr_armor_is_expanded" value="on" />
            <div class="flex-row protection-locations flex-middle">
              <div class="flex-col flex-middle">
                <span>Tête</span>
                <input type="number" name="attr_head_armor" placeholder="0" />
              </div>
              <div class="flex-col flex-middle">
                <span>Torse</span>
                <input type="number" name="attr_torso_armor" placeholder="0" />
              </div>
              <div class="flex-col flex-middle">
                <span>Bras gauche</span>
                <input type="number" name="attr_left_arm_armor" placeholder="0" />
              </div>
              <div class="flex-col flex-middle">
                <span>Bras droit</span>
                <input type="number" name="attr_right_arm_armor" placeholder="0" />
              </div>
              <div class="flex-col flex-middle">
                <span>Jambe gauche</span>
                <input type="number" name="attr_left_leg_armor" placeholder="0" />
              </div>
              <div class="flex-col flex-middle">
                <span>Jambe droite</span>
                <input type="number" name="attr_right_leg_armor" placeholder="0" />
              </div>
            </div>
            <textarea class="armor-extra" placeholder="Description et effets supplémentaires"></textarea>
          </div>
        </fieldset>
      </div>
    </div>
  </div>

  <!-- Arsenal tab -->
  <div class="tab flex-col full-width flex-middle arsenal">
    <h2 class="full-width tablet-title">Armement</h2>
    <fieldset class="repeating_weapons">
      <div class="weapon flex-col flex-middle full-width">
        <div class="flex-row full-width flex-middle">
          <input
            type="text"
            name="attr_weapon_name"
            class="weapon-title full-width"
            placeholder="Nom de l'arme"
          />
          <input
            type="number"
            name="attr_weapon_weight"
            class="weapon-weight"
            placeholder="Poids"
          />
          <div class="modif-wrapper">
            <input
              type="checkbox"
              name="attr_weapon_is_expanded"
              class="modif-toggle"
              checked
            />
            <span></span>
          </div>
        </div>
        <input type="hidden" name="attr_weapon_is_expanded" value="on" />
        <div class="weapon-details flex-col flex-middle full-width">
          <div class="full-width flex-row center-v">
            <select class="weapon-meta-option" name="attr_weapon_category">
              <option value="distance">Distance</option>
              <option value="contact">Contact</option>
            </select>
          </div>
        </div>
      </div>
    </fieldset>
  </div>

  <!-- Gear tab -->
  <div class="tab flex-col full-width flex-middle gear">

    <!-- Inventory global stats -->
    <div class="tablet flex-column flex-middle heading full-width">
      <h2 class="tablet-title">Conteneurs</h2>
      <fieldset class="repeating_character-containers">
        <div class="container flex-row flex-middle full-width tablet-line">
          <input type="text" placeholder="Nom du conteneur" class="full-width" name="attr_container_name" />
          <input
            type="number"
            placeholder="0"
            class="tablet-bubble-input"
            title="Capacité"
            name="attr_container_capacity"
          />
        </div>
      </fieldset>
      <input type="hidden" name="attr_overweight" value="false" />
      <div class="capacity-header">
        <img src="https://fpilot.fr/starclock/gui/weight.png" />
      </div>
      <input type="hidden" name="attr_total_weight" value="0" />
      <input type="hidden" name="attr_total_capacity" value="0" />
      <input type="hidden" name="attr_total_eqp_weight" value="0" />
      <input type="hidden" name="attr_total_eqp_capacity" value="0" />
      <div class="flex-row flex-middle">
        <div class="weight-wrapper flex-col flex-middle">
          <h3>Inventaire</h3>
          <div class="capacity-summary flex-row flex-middle">
            <input type="number" name="attr_total_eqp_weight_display" value="@{total_weight}" disabled />
            <span>/</span>
            <input type="number" name="attr_total_eqp_capacity_display" value="@{total_capacity}" disabled />
          </div>
        </div>
        <div class="weight-wrapper flex-col flex-middle">
          <h3>Équipement</h3>
          <div class="capacity-summary flex-row flex-middle">
            <input type="number" name="attr_total_eqp_weight_display" value="@{total_eqp_weight}" disabled />
            <span>/</span>
            <input type="number" name="attr_total_eqp_capacity_display" value="@{total_eqp_capacity}" disabled />
          </div>
        </div>
      </div>
      </div>

    <div class="tablet-content flex-col flex-middle full-width">
      <fieldset class="repeating_character-items">
        <div class="item-container full-width flex-row flex-middle">
          <input
            type="text"
            name="attr_item_name"
            class="full-width line-input"
            placeholder="Nom de l'objet"
          />
          <span>x</span>
          <input
            type="number"
            name="attr_item_qty"
            class="item-qty line-input"
            value="0"
          />
          <img src="https://fpilot.fr/starclock/gui/weight.png" />
          <input
            type="number"
            name="attr_item_weight"
            class="item-weight line-input"
            value="0"
          />
        </div>
      </fieldset>
    </div>
  </div>

  <!-- Psy tab -->
  <div class="tab flex-col full-width flex-middle psy">
    <h2 class="tablet-title">Karma</h2>
    <div class="karma-container flex-row flex-middle">
      <div class="karma-unit">
        <input
          type="radio"
          value="-3"
          name="attr_current_karma"
        />
        <p>-3</p>
      </div>
      <div class="karma-unit">
        <input
          type="radio"
          value="-2"
          name="attr_current_karma"
        />
        <p>-2</p>
      </div>
      <div class="karma-unit">
        <input
          type="radio"
          value="-1"
          name="attr_current_karma"
        />
        <p>-1</p>
      </div>
      <div class="karma-unit">
        <input
          type="radio"
          value="0"
          name="attr_current_karma"
          checked
        />
        <p>0</p>
      </div>
      <div class="karma-unit">
        <input
          type="radio"
          value="1"
          name="attr_current_karma"
        />
        <p>1</p>
      </div>
      <div class="karma-unit">
        <input
          type="radio"
          value="2"
          name="attr_current_karma"
        />
        <p>2</p>
      </div>
      <div class="karma-unit">
        <input
          type="radio"
          value="3"
          name="attr_current_karma"
        />
        <p>3</p>
      </div>
    </div>
    <div class="psy-container flex-row full-width">
      <input type="hidden" name="attr_current_psy" />

      <!-- Telekinesie -->
      <div class="flex-col flex-middle psy-wrapper telekinesie">
        <div class="psy-card">
          <h4>Télékinésie</h4>
          <button type="action" class="psy-button" name="act_telekinesie"></button>
          <span class="power-anot">P</span>
          <span class="control-anot">C</span>
          <input
            type="number"
            class="psy-power"
            name="attr_telekinesie_power"
            value="0"
          />
          <input
            type="number"
            class="psy-control"
            name="attr_telekinesie_control"
            value="0"
          />
        </div>
        <div class="full-width tablet-content psy-content">
          Coucou
        </div>
      </div>

      <!-- Mentalisme -->
      <div class="flex-col flex-middle psy-wrapper mentalisme">
        <div class="psy-card">
          <h4>Mentalisme</h4>
          <button type="action" class="psy-button" name="act_mentalisme"></button>
          <span class="power-anot">P</span>
          <span class="control-anot">C</span>
          <input
            type="number"
            class="psy-power"
            name="attr_mentalisme_power"
            value="0"
          />
          <input
            type="number"
            class="psy-control"
            name="attr_mentalisme_control"
            value="0"
          />
        </div>
        <div class="full-width tablet-content psy-content">
          Blah
        </div>
      </div>

      <!-- Thermokinesie -->
      <div class="flex-col flex-middle psy-wrapper thermokinesie">
        <div class="psy-card">
          <h4>Thermokinésie</h4>
          <button type="action" class="psy-button" name="act_thermokinesie"></button>
          <span class="power-anot">P</span>
          <span class="control-anot">C</span>
          <input
            type="number"
            class="psy-power"
            name="attr_thermokinesie_power"
            value="0"
          />
          <input
            type="number"
            class="psy-control"
            name="attr_thermokinesie_control"
            value="0"
          />
        </div>
        <div class="full-width tablet-content psy-content">
          Bite
        </div>
      </div>

      <!-- Chronomancie -->
      <div class="flex-col flex-middle psy-wrapper chronomancie">
        <div class="psy-card">
          <h4>Chronomancie</h4>
          <button type="action" class="psy-button" name="act_chronomancie"></button>
          <span class="power-anot">P</span>
          <span class="control-anot">C</span>
          <input
            type="number"
            class="psy-power"
            name="attr_chronomancie_power"
            value="0"
          />
          <input
            type="number"
            class="psy-control"
            name="attr_chronomancie_control"
            value="0"
          />
        </div>
        <div class="full-width tablet-content psy-content">
        <!--
          <fieldset class="repeating_psy_power">
            <div class="full-width flex-col flex-middle psy-power">
              <div class="flex-row full-width">
                <input
                  type="text"
                  name="attr_power_name"
                  class="power-name"
                  placeholder="Nom du pouvoir"
                />
                <input
                  type="number"
                  name="attr_power_level"
                  placeholder="Niv."
                />
              </div>
              <textarea
                class="psy-description"
                name="attr_power_description"
              ></textarea>
            </div>
          </fieldset>
          -->
        </div>
      </div>

    </div>
  </div>

  <!-- Mutations tab -->
  <div class="tab flex-col full-width flex-middle mutations">
    <h2 class="tablet-title">Mutations</h2>
    <fieldset class="repeating_mutations">
      <div class="full-width mutation flex-col flex-middle">
        <input type="hidden" name="attr_mutation_is_expanded" value="on" />
        <div class="full-width flex-row">
          <input
            type="text"
            class="full-width"
            name="attr_mutation_name"
            placeholder="Nom de la mutation"
          />
          <div class="modif-wrapper">
            <input
              type="checkbox"
              name="attr_mutation_is_expanded"
              class="modif-toggle"
              checked
            />
            <span></span>
          </div>
        </div>
        <textarea
          name="attr_mutation_description"
          placeholder="Description de la mutation"
          rows="5"
        ></textarea>
      </div>
    </fieldset>
  </div>

  <!-- XP tab -->
  <div class="tab flex-col full-width flex-middle xp">
    <h2 class="tablet-title">Expérience acquise</h2>
    <table class="xp-summary full-width">
      <thead>
        <tr>
          <th class="xp-subheader">Acquis</th>
          <th class="xp-subheader">Dépensé</th>
          <th class="xp-subheader">Restant</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            <input
              type="number"
              name="attr_xp_earned"
              value="0"
              min="0"
            />
          </td>
          <td>
            <input
              disabled
              type="number"
              name="attr_xp_spent_display"
              value="@{xp_spent}"
            />
          </td>
          <td>
            <input
              type="hidden"
              name="attr_xp_is_overflowing"
              value="false"
            />
            <input
              disabled
              type="number"
              name="attr_xp_remaining"
              value="@{xp_earned} - @{xp_spent}"
            />
            <div class="warning-symbol">!</div>
          </td>
        </tr>
      </tbody>
    </table>
    <table class="full-width advancements-reminder">
      <thead>
        <tr>
          <th colspan="2">Coûts des avancées</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Caractéristique +1</td>
          <td>4 EXP</td>
        </tr>
        <tr>
          <td>Connaître une compétence</td>
          <td>(Nb. de compétences déjà connues + 1) EXP</td>
        </tr>
        <tr>
          <td>Devenir expert dans une compétence</td>
          <td>5 EXP</td>
        </tr>
        <tr>
          <td>Devenir maître dans une compétence</td>
          <td>10 EXP</td>
        </tr>
        <tr>
          <td>Obtenir une connaissance</td>
          <td>(Nb. de connaissances déjà connues + 1) EXP</td>
        </tr>
        <tr>
          <td>Puissance d'une forme sensorielle +1</td>
          <td>(Puissance désirée x 2) EXP</td>
        </tr>
        <tr>
          <td>Contrôle d'une forme sensorielle +1</td>
          <td>(Contrôle désiré x 2) EXP</td>
        </tr>
        <tr>
          <td>Nouvelle mutation contrôlée</td>
          <td>(Coûts en points de mutation) EXP</td>
        </tr>
      </tbody>
    </table>
    <h2 class="tablet-title">Expérience dépensée</h2>
    <fieldset class="repeating_advancements">
      <div class="flex-row full-width">
        <div class="advancement-cell third-width">
          <input
            type="text"
            name="attr_adv_name_1"
            placeholder="Avancée"
          />
          <input
            type="number"
            name="attr_adv_cost_1"
            placeholder="Coût"
          />
        </div>
        <div class="advancement-cell third-width">
          <input
            type="text"
            name="attr_adv_name_2"
            placeholder="Avancée"
          />
          <input
            type="number"
            name="attr_adv_cost_2"
            placeholder="Coût"
          />
        </div>
        <div class="advancement-cell third-width">
          <input
            type="text"
            name="attr_adv_name_3"
            placeholder="Avancée"
          />
          <input
            type="number"
            name="attr_adv_cost_3"
            placeholder="Coût"
          />
        </div>
      </div>
    </fieldset>
  </div>
</div>

<!-- General rolltemplate -->
<rolltemplate class="sheet-rolltemplate-general">
  <div class="sheet-rolltemplate-wrapper">
    <table class="sheet-rolltable">
      <thead>
        <tr>
          <th colspan="2" class="sheet-rolltable-title">{{character_name}}</th>
        </tr>
        <tr>
          <th colspan="2" class="sheet-rolltable-subtitle">{{roll_title}}</th>
        </tr>
        <tr>
          <th colspan="2">
            {{#rollWasCrit() roll}}
              <div class="sheet-success sheet-critical">Réussite critique</div>
            {{/rollWasCrit() roll}}
            {{#rollWasFumble() roll}}
              <div class="sheet-failure sheet-critical">Échec critique</div>
            {{/rollWasFumble() roll}}
            {{#^rollWasCrit() roll}}
              {{#^rollWasFumble() roll}}
                {{#rollGreater() roll target}}
                  {{#^rollTotal() roll target}}
                    <div class="sheet-failure">Échec</div>
                  {{/^rollTotal() roll target}}
                {{/rollGreater() roll target}}
                {{#rollLess() roll target}}
                  <div class="sheet-success">Réussite</div>
                {{/rollLess() roll target}}
                {{#rollTotal() roll target}}
                  <div class="sheet-success">Réussite</div>
                {{/rollTotal() roll target}}
              {{/^rollWasFumble() roll}}
            {{/^rollWasCrit() roll}}
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td class="sheet-rollresult">{{roll}}</td>
          <td class="sheet-target">{{target}}</td>
        </tr>
      </tbody>
    </table>
  </div>
</rolltemplate>

<!-- Workers -->
<script type="text/worker">

  /*
  **  Constants
  */

  var calculationKeys = ["base", "bonus"];
  var statsKeys = ["phy", "agi", "acu", "hab", "cha", "emp", "int", "wil"];
  var tabs = ["character", "protections", "arsenal", "gear", "psy", "xp", "mutations"];
  var bodyLocations = ["head", "torso", "left_arm", "right_arm", "left_leg", "right_leg"];
  var psyDisciplines = ["telekinesie", "thermokinesie", "chronomancie", "mentalisme"];

  /*
  **  Helper functions
  */

  function noop (x) {
    return x;
  }

  function getRangeForWeaponType (weaponType, distance, range) {
    var defaultRanges = {
      short: range,
      medium: range,
      long: range
    };

    return ({
      pistol: defaultRanges
    }[weaponType] || defaultRanges)[distance] || range;
  }

  function getWeaponRanges (weaponType, caliber) {
    return (
      Object.keys(caliber.ranges)
        .reduce(function (acc, distance) {
          const range = caliber.ranges[distance];
          return Object.assign(acc, {
            distance: getRangeForWeaponType(weaponType, distance, range)
          });
        }, {})
    );
  }

  function calculateTotal (statKey) {
    var keys = calculationKeys.map(function (key) { return statKey + "_" + key; });

    getAttrs(keys, function (values) {
      var obj = {};
      obj[statKey + "_total"] = (
        Object.values(values)
          .reduce(function (total, num) { return parseInt(num, 10) + total; }, 0)
      );
      setAttrs(obj);
    });
  }

  function computeStatChanges (statKey) {
    var callback = function () {
      calculateTotal(statKey)
    };

    var query = (
      calculationKeys
        .map(function (key) { return "change:" + statKey + "_" + key })
        .concat(["sheet:opened"])
        .join(" ")
    );

    on(query, callback);
  }

  function computeTabChange (tabKey) {
    on("clicked:" + tabKey, function () {
      setAttrs({
        current_tab: tabKey
      });
    });
  }

  function computePsyClick (psyKey) {
    on("clicked:" + psyKey, function () {
      getAttrs(["current_psy"], function (values) {
        setAttrs({
          current_psy: psyKey === values.current_psy ? "" : psyKey
        });
      });
    });
  }

  function onEvents (events, callback) {
    on(events.join(" "), callback)
  }

  /*
  **  StarClock data compendium
  */

  var formulae = {
    psyLevel: "floor((@{telekinesie_power} + @{thermokinesie_power} + @{mentalisme_power} + @{chronomancie_power}) / 4)"
  };

  var Compendium = {

    /* Guns */
    get guns () {
      return {
        star51: {
          name: "STAR-51",
          caliber: Compendium.calibers["10mm"]
        }
      };
    },

    /* Melee weapons */
    get meleeWeapons () {
      return {
        neokatana: {
          name: "Neokatana",
          damage: 12,
          penetration: 1
        },
        adeptBlade: {
          name: "Lame d'adepte",
          damage: 5,
          penetration: 0,
          formula: formulae.psyLevel
        }
      };
    },

    /* Armor */
    get armors () {
      return {};
    },

    /* Ammunition types */
    get ammo () {
      return {
        regular: {
          name: "STD",
          modifiers: {
            penetration: 0,
            damage: 0
          }
        },
        slap: {
          name: "SLAP",
          modifiers: {
            penetration: 2,
            damage: -1
          }
        }
      };
    },

    /* Calibers */
    get calibers () {
      return {
        "9mm": {
          name: "9mm",
          damage: 10,
          penetration: 1,
          ranges: {
            short: 20,
            medium: 50,
            long: 150
          }
        },
        "10mm": {
          name: "10mm",
          damage: 15,
          penetration: 1,
          ranges: {
            short: 30,
            medium: 60,
            long: 150
          }
        },
        "556x45": {
          name: "5.56x45mm",
          damage: 15,
          penetration: 2,
          ranges: {
            short: 50,
            medium: 100,
            long: 250
          }
        }
      };
    }
  };

  /*
  **  Effective code
  */

  statsKeys.forEach(computeStatChanges);
  psyDisciplines.forEach(computePsyClick);
  tabs.forEach(computeTabChange);

  onEvents([
    "sheet:opened",
    "change:phy_total",
    "change:repeating_character-containers:container_capacity",
    "remove:repeating_character-containers:container_capacity"
  ], function () {
    getSectionIDs("repeating_character-containers", function (ids) {
      var prefix = "repeating_character-containers_";
      var fields = ids.map(function (id) {
        return prefix + id + "_container_capacity";
      });

      getAttrs(fields.concat(["phy_total"]), function (values) {
        var containerCapacity = ids.reduce(function (total, id) {
          return total + parseInt(values[prefix + id + "_container_capacity"] || "0", 10);
        }, 0);

        var phyMod = Math.floor(parseInt(values.phy_total || "0", 10) / 10);

        setAttrs({
          total_capacity: containerCapacity + phyMod,
          total_eqp_capacity: phyMod * 2
        });
      });
    });
  });

  onEvents([
    "sheet:opened",
    "change:repeating_character-items:item_qty",
    "change:repeating_character-items:item_weight",
    "change:repeating_armors:armor_weight",
    "change:repeating_weapons:weapon_weight",
    "remove:repeating_character-items",
    "remove:repeating_armors",
    "remove:repeating_weapons"
  ], function () {
    getSectionIDs("repeating_character-items", function (itemIds) {
      var itemPrefix = "repeating_character-items_";
      var fields = itemIds.reduce(function (acc, id) {
        return acc.concat([itemPrefix + id + "_item_qty", itemPrefix + id + "_item_weight"]);
      }, []);

      getSectionIDs("repeating_armors", function (equipIds) {
        var equipPrefix = "repeating_armors_";
        var equipFields = equipIds.reduce(function (acc, id) {
          return acc.concat([equipPrefix + id + "_armor_weight"]);
        }, []);

        getSectionIDs("repeating_weapons", function (weaponIds) {
          var weaponPrefix = "repeating_weapons_";
          var weaponFields = weaponIds.reduce(function (acc, id) {
            return acc.concat([weaponPrefix + id + "_weapon_weight"]);
          }, []);

          getAttrs(fields.concat(equipFields).concat(weaponFields).concat(["total_capacity", "total_eqp_capacity"]), function (values) {
            var totalWeight = itemIds.reduce(function (total, id) {
              var weight = parseInt(values[itemPrefix + id + "_item_weight"] || "0", 10);
              var qty = parseInt(values[itemPrefix + id + "_item_qty"] || "0", 10);
              return total + (weight * qty);
            }, 0);

            var totalEquipWeight = equipIds.reduce(function (total, id) {
              var weight = parseInt(values[equipPrefix + id + "_armor_weight"] || "0", 10);
              return total + weight;
            }, 0);

            var totalWeaponWeight = weaponIds.reduce(function (total, id) {
              var weight = parseInt(values[weaponPrefix + id + "_weapon_weight"] || "0", 10);
              return total + weight;
            }, 0);

            setAttrs({
              total_weight: totalWeight,
              total_eqp_weight: (totalEquipWeight + totalWeaponWeight),
              overweight: (
                totalWeight > parseInt(values.total_capacity || "0", 10) ||
                totalEquipWeight > parseInt(values.total_eqp_capacity || "0", 10)
              ) ? "true" : "false"
            });
          });
        });
      });
    });
  });

  onEvents(["sheet:opened", "remove:repeating_armors"].concat(bodyLocations.reduce(function (acc, location) {
    return acc.concat([
      "change:repeating_armors:" + location + "_armor",
      "change:" + location + "_protection_bonus"
    ]);
  }, [])), function () {
    getSectionIDs("repeating_armors", function (ids) {
      var prefix = "repeating_armors_";
      var fields = ids.reduce(function (acc, id) {
        return acc.concat(bodyLocations.map(function (location) {
          return prefix + id + "_" + location + "_armor";
        }));
      }, []);

      getAttrs(fields.concat(bodyLocations.map(function (location) {
        return location + "_protection_bonus";
      })), function (values) {
        var armorValues = bodyLocations.reduce(function (acc, location) {
          var obj = {};
          obj[location + "_protection_total"] = parseInt(values[location + "_protection_bonus"] || "0", 10) + (
            ids.reduce(function (total, id) {
              return total + parseInt(values[prefix + id + "_" + location + "_armor"] || "0", 10);
            }, 0)
          );

          return Object.assign(acc, obj);
        }, {});

        setAttrs(armorValues);
      });
    });
  });

  onEvents([
    "sheet:opened",
    "change:repeating_advancements:adv_cost_1",
    "change:repeating_advancements:adv_cost_2",
    "change:repeating_advancements:adv_cost_3",
    "change:xp_earned",
    "remove:repeating_advancements"
  ], function () {
    getSectionIDs("repeating_advancements", function (ids) {
      var prefix = "repeating_advancements_";
      var fields = ids.reduce(function (acc, id) {
        return acc.concat([
          prefix + id + "_adv_cost_1",
          prefix + id + "_adv_cost_2",
          prefix + id + "_adv_cost_3"
        ]);
      }, []);

      var extraKeys = ["xp_earned"];

      getAttrs(fields.concat(extraKeys), function (values) {
        var totalCost = Object.keys(values).reduce(function (total, key) {
          if (extraKeys.includes(key)) {
            return total;
          }

          var cost = values[key];
          return total + parseInt((cost || "0"), 10);
        }, 0);

        setAttrs({
          xp_spent: totalCost,
          xp_is_overflowing: totalCost > values.xp_earned ? "true" : "false"
        });
      });
    });
  });
</script>
